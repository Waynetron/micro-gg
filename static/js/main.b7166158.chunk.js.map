{"version":3,"sources":["Game/images sync /^/.//.*/.png$","Game/images/tiles/tile0.png","Game/images/tiles/tile1.png","Game/images/tiles/tile2.png","Game/images/tiles/tile3.png","Game/images/tiles sync /^/.//.*/.png$","icons/moon.svg","icons/sun.svg","icons/play.svg","icons/stop.svg","Game/images/Brick.png","Game/images/Goomba.png","Game/images/GoombaRed.png","Game/images/Player.png","Game/images/QuestionBrick.png","Game/images/Spike.png","Game/images/no-image.png","ExamplesModal/exampleCode.js","App/reducer.js","Game/constants.js","util/state.js","util/parse.js","Game/physics.js","Game/reducer.js","SpriteEditor/reducer.js","reducers.js","firebase.js","debug/DebugColliding.js","Image/LetterImage.js","Image/helper.js","Game/Sprite.js","Game/Effect.js","Game/Game.js","components/Button.js","Menu/Menu.js","Game/Loop.js","ImagePicker/ImagePicker.js","Code/Code.js","SpriteEditor/Tile.js","SpriteEditor/SpriteEditor.js","Persistor/Persistor.js","components/Modal.js","ExamplesModal/ExamplesModal.js","GamesModal/GamesModal.js","components/Input.js","components/IconButton.js","App/colors.js","Keyboard/Keyboard.js","App/actions.js","Game/actions.js","App/App.js","index.js"],"names":["map","./Brick.png","./Goomba.png","./GoombaRed.png","./Player.png","./QuestionBrick.png","./Spike.png","./no-image.png","./tiles/tile0.png","./tiles/tile1.png","./tiles/tile2.png","./tiles/tile3.png","webpackContext","req","id","webpackContextResolve","__webpack_require__","e","Error","code","keys","Object","resolve","module","exports","./tile0.png","./tile1.png","./tile2.png","./tile3.png","p","examples","simple_movement","gravity_flip","sliding_puzzle","simple_platformer","four_way_movement","follow_player","initialGame","name","uniqid","Plain","deserialize","defaultState","games","theme","user","active","appReducer","state","arguments","length","undefined","action","type","objectSpread","currentGame","TOP","LEFT","RIGHT","createNewSprite","x","y","letter","position","rotation","prevPosition","velocity","maxVelocity","acceleration","friction","colliding","top","bottom","left","right","positioning","static","inputs","trimBrackets","rawString","leftBracket","rightBracket","string","trim","isObject","isList","openIndex","indexOf","closeIndex","lastIndexOf","substr","states","UP","DOWN","FAST_UP","FAST_DOWN","FAST_LEFT","FAST_RIGHT","SLOW_UP","SLOW_DOWN","SLOW_LEFT","SLOW_RIGHT","JUMP","FLIP","flip","MIRROR","mirror","DEAD","dead","STATIC","STATIONARY","WIN","win","LOSE","lose","<UP>","<DOWN>","<LEFT>","<RIGHT>","<ACTION>","<ACTION1>","<ACTION2>","getCollidingForSide","side","traverseDirection","currentIndex","COLLIDING_OR_POSITIONING","nextIndex","collidesWith","console","error","nextColliding","defineProperty","getColliding","direction","leftStates","leftIndex","frontSide","down","up","directionToSide","backSide","forward","getOpposite","frontColliding","backColliding","wordsToState","words","names","statesArr","word","isOperator","_word$split","split","_word$split2","slicedToArray","newState","_arr","_i","key","negative","includes","_word$split3","_word$split4","number","Number","isNaN","rightState","resultState","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","Symbol","iterator","next","done","stateObj","value","merge","err","return","propertyRegex","wordRegex","objectRegex","listRegex","numberRegex","operatorRegex","isWord","Boolean","match","isProperty","isNumberString","splitOnFirstWordGroup","numOpenBrackets","i","char","charAt","slice","splitOnObject","_string$match","property","replace","remainder","concat","splitOnProperty","_string$match3","_string$match5","numberString","stringToWordGroups","_splitOnFirstWordGrou","_splitOnFirstWordGrou2","rest","toConsumableArray","stringToState","wordGroups","group","_property$split","_property$split2","trimmed","innerState","valueState","propertyToState","parseFloat","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","push","_i2","getStateTransitions","rules","sprites","transitions","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_step8","_iterator8","sprite","_iteratorNormalCompletion9","_didIteratorError9","_iteratorError9","_step9","_iterator9","rule","_rule","matches","isCreateNewState","createNew","flashDead","flash","flagDeadForRemoval","remove","isCollisionRule","line","isRule","isLevel","isLegend","standardExpansions","ALL","MOVE","SLOW_MOVE","HORIZONTAL","VERTICAL","replaceWord","newWord","newLine","isExpandable","expansions","_arr2","expandRules","lines","notExpandable","filter","expanded","flatten","entries","_ref3","_ref2","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","expandRule","addImplicitKeywords","_line$split7","appendedLine","parseRules","variables","_ruleStrings2","_ref4","_ruleStrings4","customExpansions","regularRules","ruleStrings","ruleString","_ruleString$split","_ruleString$split2","ruleStringToState","collisionRules","separator","_ruleString$match","firstWord","toLowerCase","_ruleString$replace$s","_ruleString$replace$s2","leftWordGroupArrays","rightWordGroupArrays","rightStates","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","leftStatesWithColliding","index","rightIndex","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","matchingLeft","subState","newSprite","leftState","collisionRuleStringToState","collisionCreate","collisionModify","modify","create","roundToPixels","Math","round","getEdges","isOverlapping","spriteA","spriteB","a","b","overlapsPoint","point","padding","_getEdges","overlapsSide","points","getPointsForSide","getCollidedEdges","prevEdgesA","prevEdgesB","collidedEdges","getSeparatedState","edgeA","edgesB","applySpriteCollisions","newSpriteA","storePreviousPosition","applyAcceleration","max","min","applyVelocity","resetColliding","resetPositioning","snapNearZero","num","abs","applyFriction","currentView","effects","width_in_tiles","height_in_tiles","debug","imageMap","regular","stateTransitions","availableImages","freezeFrames","shake","removeComments","join","getNextView","winners","losers","gameReducer","variableName","imageName","_ref8","serialize","level","legend","row","forEach","col","getName","parseSprites","_line$split$map","str","_line$split$map2","symbol","randIndex","floor","random","parseLegend","namesArr","_line$split","parseNames","reduce","obj","item","objects","results","_line$split3","_line$split4","expansion","parseObjects","lists","_line$split5","_line$split6","list","parseLists","_getLevelDimensions","getLevelDimensions","_getLevelDimensions2","width","height","_sprites3","spritesToKeep","effectsToKeep","effect","progress","duration","isAlive","newSprites","newEffects","deadSprite","stateToAdd","vectorA","vectorB","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_iterator7","transition","_transition","getNewStateToAdd","updatedSprites","addNewState","edge","collidingSprite","updateSpriteCollidingState","removePositioningState","updateSpritePositioningState","newPosition","newVelocity","applyWallCollisions","newStates","result","_iteratorNormalCompletion10","_didIteratorError10","_iteratorError10","_step10","_iterator10","mergeWith","applyStateTransitions","updatedEffects","input","newInputs","initialTileSets","tileImages","rasterise","tileSet","canvas","document","createElement","ctx","getContext","rowIndex","colIndex","tileImage","image","Image","onload","log","drawImage","src","toDataURL","tileSets","open","images","spriteEditorReducer","combineReducers","app","game","spriteEditor","firebaseInitialized","firebase","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","enablePersistence","catch","DebugColliding","_ref","react_default","className","seed","sin","LetterImageContainer","styled","div","withConfig","displayName","componentId","props","codePointAt","h","s","l","randomColor","LetterImage","assign","getImageFilename","SpriteContainer","attrs","style","Inner","transform","Sprite","imageFilename","alt","require","Image_LetterImage","DebugColliding_DebugColliding","Container","Explosion","Effect","Stage","css","connect","Game_Sprite","Game_Effect","Button","button","colors","dark","primary","secondary","inverted","text","Menu","onPlay","components_Button","onClick","dispatch","onTimeChange","request","useEffect","requestAnimationFrame","advanceFrame","cancelAnimationFrame","PickerContainer","PickerBox","onSetImage","onSetNoImage","_useState","useState","_useState2","setOpen","onMouseOver","onMouseLeave","grammar","comment","variable","pattern","RegExp","getContent","token","content","decorateNode","node","editor","others","texts","getTexts","toArray","t","tokens","Prism","tokenize","decorations","startText","shift","endText","startOffset","endOffset","start","newlines","end","available","remaining","dec","anchor","offset","focus","mark","setCode","compile","save","slate_react_es","onChange","renderMark","children","attributes","_node$text$split$map","_node$text$split$map2","src_ImagePicker_ImagePicker","opacity","fontWeight","spellCheck","getPositionStyle","Tile","img","SpritePicker","selectedTileSet","onSelect","Preview","tiles","selectedTile","rowArr","tileIndex","src_SpriteEditor_Tile","TilePicker","_ref5","updateTileSets","onClose","setSelectedTileSet","_useState3","_useState4","setSelectedTile","Dialog_default","SpriteEditor_SpritePicker","SpriteEditor_Preview","newTileIndex","newTileSets","SpriteEditor_TilePicker","firestore","saveGame","codeText","collection","uid","doc","set","then","loadGames","get","querySnapshot","_doc$data","data","clearGames","Blanket","Contents","Modal","stopPropagation","CodeExample","ColumnLayout","loadPreset","visible","setVisible","components_Modal","react","react_textarea_autosize_esm_browser","loadGame","Input","alpha","IconButton","darkColors","light","lightColors","keyMap","sequence","action1","action2","cancel_up","cancel_down","cancel_left","cancel_right","cancel_action1","cancel_action2","handlers","onSetInput","onCancelInput","onReset","onRun","onToggleDebug","isGameActive","r","d","space","setGameActive","setInput","cancelInput","onToggleTheme","onOpenCloseSpriteEditor","index_es","providers","google","firebaseApp","GoogleAuthProvider","AppContainer","updateName","signOut","auth","signInWithGoogle","signInWithPopup","react_custom_properties_default","properties","--primary-color","--secondary-color","--dark-color","--primary-transparent-color","primaryTransparent","--light-color","--hover-color","Persistor","components_Input","target","toUpperCase","onFocus","select","src_GamesModal_GamesModal","src_ExamplesModal_ExamplesModal","components_IconButton","sun","moon","src_Code_Code","src_Keyboard_Keyboard","stop","play","Game_Loop","src_SpriteEditor_SpriteEditor","src_Game_Game","Menu_Menu_Menu","store","createStore","rootReducers","window","__REDUX_DEVTOOLS_EXTENSION__","ReactDOM","render","es","src_App_App","getElementById"],"mappings":"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","file":"static/js/main.b7166158.chunk.js","sourcesContent":["var map = {\n\t\"./Brick.png\": 418,\n\t\"./Goomba.png\": 419,\n\t\"./GoombaRed.png\": 420,\n\t\"./Player.png\": 421,\n\t\"./QuestionBrick.png\": 422,\n\t\"./Spike.png\": 423,\n\t\"./no-image.png\": 424,\n\t\"./tiles/tile0.png\": 180,\n\t\"./tiles/tile1.png\": 181,\n\t\"./tiles/tile2.png\": 182,\n\t\"./tiles/tile3.png\": 183\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) { // check for number or string\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn id;\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 126;","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAChJREFUWAnt0IEAAAAAw6D5Ux/khVBhwIABAwYMGDBgwIABAwYMvA8MECAAAc4qtccAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAADZJREFUWAnt0EENAEAIA8HjzOMGi5Bggs/UwDYT2dXvcP+wvWkHCBAgQIAAAQIECBAgQIAAgQGlEANzhaA9CAAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAN1JREFUWAnF0EsOwyAQg2HUi7VH867H6RFT/4tIUZQHkBmwxHb8mVIm5rv8Pq+J/VRrGoD1pSzvaQDW+5UpgHX9NICLRTkZ/gPb9VMALhXFa4b+wH49iKEA94nSbYYBjtYDGQZwlyjcZwjgbD2YIQD3iLKjpAOu1gNKB7hDFJ0lFXC3HlQqwPdFyVXSADXrgaUBfFsU3CUFULseXArAd8XxmoQDWtYDDAf4pjhcm1BA63qQoQDfE0dbEgboWQ80DOBb4mBrQgC968GGAHxHHOvJY8CT9YAfA3xDHOrNH5CJQjHdlUHlAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAARJJREFUWAljZCASrPp/le0ew23H/wz//RgZGLT+MzBIMTD8B2IGHiKNwKoMaBZ+0PV/q8Q/hl91QAujgRby4VdNuixOB0z6v439K8PPaqCCIqCvuUk3mjgdWB0A8fXP9UBfWxBnDPmqMBzQ/X+j3l+Gv1uBlsuQbyzxOlEcAPX5aXpZDnImE8ytoDj/xwAOdrr4HGYvC4wBSnBANs3jHGYfjAZHATSr3aFlaodZiE6DowCSz2mX1dAtReYzgUo4SCGDLEw/NhOoeKVFCUesF5hAZTuximmhjgmYCrVoYTCxZgJDAFSrDRwA5gJwlTpgLgBlQ4rqc0pdDi+KKTWIXP2jDhgNgdEQGA2B0RAYDYHREAAA23dKamEoqhoAAAAASUVORK5CYII=\"","var map = {\n\t\"./tile0.png\": 180,\n\t\"./tile1.png\": 181,\n\t\"./tile2.png\": 182,\n\t\"./tile3.png\": 183\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) { // check for number or string\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn id;\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 184;","module.exports = __webpack_public_path__ + \"static/media/moon.5a53c948.svg\";","module.exports = __webpack_public_path__ + \"static/media/sun.a78e8514.svg\";","module.exports = __webpack_public_path__ + \"static/media/play.e5a8524f.svg\";","module.exports = __webpack_public_path__ + \"static/media/stop.f437901f.svg\";","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAD5JREFUWAnt10ERADAIA7Ax87iZRXao6CcYaMmv1fPmJC9ZYLNv8vnNVoAAAQIECBAgQIAAAQIECFRyHe84/XTlDQmQUCOUAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAYdJREFUWAntVz1LA0EQfbuEeAgi2EWsBCsL/0JqKytLf4KV+IGQIiDxxMqfYBOwECvr/AULK8FKSCeIzWlx6zzjQdibDRdwL80NhNy8zMx7O3N3YQzEUve4kePrCnBdcTvEItoYMCOLpeMTs/tmSO6QPTlgLSJpqbQB3g2Sndbk5PWSUw0P7KTr9q/tJYX1AK4rAqLPfNZZOhSwUGsENB1oOhDqwDdgTxMsr/PDa3lWBatslfNbeknbOzN76dRv6cA9iJtfTmEzLqvnqx1IkNz61TXMjyl8LVbDGK8KKArV8a0KyJAd+OQa5scUvharYYw3A3cv/4wl403UK9o2Sc77EtUuRepA5fyQAL1sBFQdQQSeYMlGQOBFJHcn7Pkmtq73zfY8b0C11Xfuuf2KlyOH/MIPCI5gBas3/0FOQtZhPZ+cflDAJz4OqVxLmhdjHdbT8prHMDgCrV0xMAqQXW1hNhYBZrQwei6p3FK5KNYtgpzktr8rsmyp0omhiKhjHMJhhtyMyf0DfCpzwbzHSMoAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAYxJREFUWAntV0FKw1AQnT82WRQqtDvFdbdewVN06RFciRUCLiwFI648QjdCT+EV3HYtuEvRgosEE+dFAk2Y3ybgTzcZKM1M3rw3mUk+/xsS+w7DsyRJHg3RRZZlJ4i5MmPMR0b06nneTX86fTe5eBy/ieDIlaiFN/J8/5zx5AcQR00jaDPaDu8QBm12PfNdDwZt3gVo415XQNeBrgNqB2SBiA3zbY/5FD9cI1b3s2yS31NJme+OgyDcuhd+zedEafqwFbNfNshXO3BEtKiya7EqpvA1rBYDXi2gIGrjXy3gh+iyKq7FqpjC17BaDHjzOZvJ/qBs+Qsncyzalien6b0A/TJS95rkqwXotG6i6gjcSOmsXQH6QiTdkt1rMBiPn8xkUnsF1JtMlC2X/ma1upYdkKxmZbOOYDAcPv+HOOTAA76y9J9nLWCzXl+hci2paSzvgPBped1naB2B1i4XMcZZzQVxHU5oMw6KdcAuMNBmnFKFPHIhsIczgjbjiIxTqqw8L22MI9cQLWhC+xfEpII8G45emQAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAU5JREFUWAljZCAA2v+v+09ACU5pRgbG/xWMgUw4FQAl8Eri00gtuVEHjIbAaAgMeAgwUlLQUKMsGPAQGHXAaAjgDAFgVTodhClN6YTMwZkNKxmDGEGWU5JNkdsDuMzBGQKU+pxY/SyEFMJCgpA6cuUJhgAw6Cb+//8fHB2kWALS0/F/fSchPQQdADQgr5Nhw2yggcSoBdu3//9+FqCeeUBOKTUcwPCf4X9yJ8P6pSCDCRnY9/8Y50mGD8CW7P8EQmpB8gSDFi31buJm4AjLY/T6ic3w/v/rBX4wMGxiYPhvCzGc+q1iv68MP7fM/L+ZC90B/f93SP5g+H8QZjlIHhgKBD1IdLwiLPzv8p7hz87e/xtkYWLd/zfq/WT4fhTI14OJEUsTjFNsBgF9ZvOL4f8joBzYh38Y/l7Epo4YMTJCgBhjiVcz6oDREBjwEAAAwOJpSUqjPhYAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAX5JREFUWAlj/Njc/J9hIMFAOgBkN9NAeh5k96gDRkNgNARYKMmGXzs7pf78/i3HxsDwnLOm5iE5ZpHlgM9tbaL//v1b9OfXLw+Qpb+A+FNLyz5eLq5QxqKid6Q4hKw0ALR8McP//2DLGRgZ7zEyMv79//+/0+evXyeSYjlILckO+N/fLwDUpwXEX4AWJ/DX1Cj/Z2QsBRkGpO1BNCmA5ChgLCz8ALRADmYJ0OeMn1ta7EA1GuP//49g4sTSJDsA2WCw5a2tM4CWB4CiAYhrkeWJYZMcBciGfm5tLQY6Ig1sOQNDOG919X5keWLYFDkA6HN3kCVAejZvTc1aYixEV0NRFDAyMTUBDZzKwMx8Hd1gYvmUhcD//4oMf/+mMv/7x0WshejqKAoBYFkwDRj83H///AGVRYHohhPDpygEGBkY9gATIDD7M+4lxjKsaihtE/6fOZPs4KdKm5AxPf0bVp8RKUhRFBBpB15low4YDYHREBjwEGCktCTEm8mJkAQABD53sd5+Ls8AAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAhVJREFUWAm9lulOwkAUhaf1WXCNStwIavzhGmOMxrihj+JSTFqsPgpv4Wv4Fmw/JHSuR5Lb2NJhpqWUhEw7c++Z75wuIMQEn9bnZ6nruo8TSAh7kmbr5+dVEjnUbM5k1ckM0G40ZoVl1UiIUvv7+6FwAAoCh4iGzi2iJxxnMpOpCe7nLSHu2TVSmOt5Xo3P04yZAIbuRfT+kUI8Z0khNUDn42MB7m/jLrH5PFK4i8/rzlMDyH6/jsgT+7KkkCikou74/hLcX6vWkcJi1/NuVOtJ86kAaDBwVO5ZHBAv+ILT7GMM0PX9ZUgq3fN2AFxCCto6rjcGkH/uDZ2lScEIAI5WQHzF1LoRKSyjx6jeCADv+7qpe4YzTUELACdliF6ysOmIFFY7nqft0wJkcc+QgHjlY9U4FgBvtjVEeaFq1s4TlduuO7Z/LECAa6/dRFOgS0EJ0Ht/X4f7c42+fploDSkodZQAQRC86dXNKsalkAgA95twf2Ymb1BFtNHyvES9RIA83Yd4RIlPxAhAq9GowP1p2JjXAdEWUhjRHQEQUuZ27ePslpROfC4CgP96VUF0Ei/K6xw3YwVv1oh+BICkrOe1mUpHxlIIAfCsbsP9saoxr3mkUEUKR6wXAmBhateeN+PxfwpDALjfhftDLpj2CLM7SOHgbx9OoDD3bI5TsDquu4ef3C9eKHK0bXvfLvLax83hqXN+AWhR9c/gEiSNAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAW5JREFUWAntlsFOwzAMhu1qrwMSnOAtYOLCk3SDM6IVD8IFTeMp2AleqJqxS5JtrsucCSlCai6J7dj/lyxWh8+0Iig5SgKIdlXy8KI9AUw38P9uoKH12W+dcyyuc7NuoKX1HQF9cv82upDY4pe47LPils8NIEW3QK8ANONCtYYIdi1x2eeFcAEo8XiQBLETjyE/hAuAT3QZTh4V4iwQH2zwyfWgGcH2Qnu17QJY4u0DJ7Y6OdhXI/52gfPHkVhyuwBk9xLnC57GIFLBsGjDfu0f2G4AyXRCuMWlZhaAJPz1yAIYvnYTJ3WHGVVON4BTPJZ3Q7gAGlo9cWWj1Xq9TVRVcx3ylPvQdAEgVF8A2B2m9pY8uGteGd2B3U+ekbXncgHUePNWAd4riPTah92BneyXvD0tc+kCkEwFkcRj1R2EX7zP5ceV9bf8hd7Po6g153yOe+1cAEv0VJ9ou3+CU0WO5U0A0w0UvwEs2YbSId8ezJqOYuBQ4gAAAABJRU5ErkJggg==\"","export const EMPTY_GAME =\n`#################\n#               #\n#               #\n#               #\n#               #\n#       P       #\n#################\n\n// Legend\nP = Player\n\n// Rules\n{ <HORIZONTAL> Player } -> { HORIZONTAL Player }\n`\n\nexport const examples = {\nsimple_movement:\n`\n##################\n#                #\n#                #\n#       P        #\n#       #        #\n#      ###       #\n#     #####      #\n#                #\n#                #\n##################\n  \nP = Player\n# = Brick\n  \n// Accelerate down, like gravity\n{ Player } -> { DOWN Player }\n\n// Move sideways with <LEFT> and <RIGHT> arrow keys\n{ <HORIZONTAL> Player } -> { HORIZONTAL Player }\n`,\n\ngravity_flip:\n`\n#################\n#               #\n#               #\n#               #\n#               #\n#  P    G    X  #\n#################\n\n// Legend\nP = Player\nG = Goomba\nX = Goal\n\n// Horizontal input move player horizontally\n{ <HORIZONTAL> Player } -> { HORIZONTAL Player }\n\n// Press Action1 (X) to flip\nDOWN { Player <ACTION> | Any } -> { Player FLIP | Any }\nUP { Player <ACTION> | Any } -> { Player !FLIP | Any }\n\n// Flipped Player falls up, unflipped Player falls down\n{ Player FLIP } -> { Player UP }\n{ Player !FLIP } -> { Player DOWN }\n\n// If Player touches Goomba, player dies\n{ Player | Goomba } -> { DEAD Player | Goomba }\n\n// Win state\n{ Player | Goal } -> { Player WIN | Goal }\n`,\n\nsliding_puzzle:\n`\n###################\n#    #      #     #\n#                 #\n#                 #\n#                 #\n#   P    G  # x   #\n###################\n\n// Legend\nP = Player\nG = Goomba\nx = Goal\n# = Brick\n\nFlippable = [ Player Goomba ]\n\n{ <UP> STATIONARY Flippable } -> { Flippable gravity: 1 }\n{ <DOWN> STATIONARY Flippable } -> { Flippable gravity: 2 }\n{ <LEFT> STATIONARY Flippable } -> { Flippable gravity: 3 }\n{ <RIGHT> STATIONARY Flippable } -> { Flippable gravity: 4 }\n\n{ Flippable gravity: 1 } -> { Flippable UP rotation:180 }\n{ Flippable gravity: 2 } -> { Flippable DOWN rotation:0 }\n{ Flippable gravity: 3 } -> { Flippable LEFT rotation:90 }\n{ Flippable gravity: 4 } -> { Flippable RIGHT rotation:-90 }\n\n{ Goomba | Any } -> { Goomba | Goomba }\n\n// Win state\n{ Player | Goal } -> { Player WIN | Goal }\n`,\n\nsimple_platformer:\n`\n##################\n#                #\n#                #\n#                #\n#                #\n#                #\n#     ###?#  G   #\n#                #\n#    P           #\n##################\n\nP = Player\n# = Brick\n? = QuestionBrick\nG = Goomba\n\n// List syntax\nThingsThatFall = [ Player Goomba ]\n\n// Accelerate down, like gravity. On everything in the list\n{ ThingsThatFall } -> { DOWN ThingsThatFall }\n\n// Move sideways with <LEFT> and <RIGHT> arrow keys\n{ <HORIZONTAL> Player } -> { HORIZONTAL Player }\n\n// Jump when <UP> is pressed and when the bottom of Player\n// is touching Wall (Wall = anything)\nDOWN { <UP> Player | Wall } -> { JUMP Player | Wall }\n\n// Player dies if touching Goomba on the side or from below\nHORIZONTAL { Player | Goomba } -> { DEAD Player | Goomba }\nUP { Player | Goomba } -> { DEAD Player | Goomba }\n\n// Jumping on top of Goomba kills the Goomba\nDOWN { Player | Goomba } -> { Player | DEAD Goomba }\n\n// Break bricks by head-butting\nUP { Player | Brick } -> { Player | DEAD Brick }\n\n// Head-butting QuestionBrick turns it into a Goomba\nUP { Player | QuestionBrick } -> { Player | JUMP Goomba }\n`,\n\nfour_way_movement:\n`\n###############\n#             #\n#             #\n#             #\n#      P      #\n#             #\n#             #\n###############\n\nP = Player\n\n// MOVE is shorthand for UP, DOWN, LEFT and RIGHT\n// You can also use HORIZONTAL or VERTICAL\n{ <MOVE> Player } -> { MOVE Player }\n`,\n\nfollow_player:\n`\n##################\n#                #\n#   G            #\n#                #\n#                #\n#                #\n#                #\n#           P    #\n#                #\n##################\n\nP = Player\nG = Goomba\n\n{ <MOVE> Player } -> { MOVE Player }\nUP { Bro > Player } -> { SLOW_UP Bro > Player }\nDOWN { Bro > Player } -> { SLOW_DOWN Bro > Player }\nLEFT { Bro > Player } -> { SLOW_LEFT Bro > Player }\nRIGHT { Bro > Player } -> { SLOW_RIGHT Bro > Player }\n\n`\n}","import uniqid from 'uniqid';\nimport {EMPTY_GAME, examples} from '../ExamplesModal/exampleCode'\nimport Plain from 'slate-plain-serializer'\n\n\nconst createNewGame = ()=> ({\n  name: 'UNTITILED GAME',\n  id: uniqid(),\n  code: Plain.deserialize(examples.gravity_flip)\n})\n\nconst initialGame = createNewGame()\n\nconst defaultState = {\n  name: initialGame.name,\n  code: initialGame.code,\n  id: initialGame.id,\n  games: [initialGame],\n  theme: 'dark',\n  user: null,\n  active: false\n}\n\n\nconst appReducer = (state = defaultState, action) => {\n  switch (action.type) {\n    case 'SET_ACTIVE':\n      return {\n        ...state,\n        active: action.active\n      }\n    case 'TOGGLE_THEME': {\n      return {\n        ...state,\n        theme: state.theme === 'light' ? 'dark' : 'light'\n      };\n    }\n    case 'SET_NAME':\n      return {\n        ...state,\n        name: action.name\n      }\n    case 'SET_USER':\n      return {\n        ...state,\n        user: action.user\n      }\n    case 'SIGN_OUT':\n      return {\n        ...state,\n        user: null\n      }\n    case 'SET_GAMES':\n      return {\n        ...state,\n        games: action.games\n      }\n    case 'SET_CURRENT_GAME':\n      return {\n        ...state,\n        currentGame: action.currentGame\n      }\n    case 'UPDATE_CODE':\n      return {...state, code: action.code}\n    case 'LOAD_SUCCESS':\n      return {\n        ...state,\n        code: action.code\n      }\n    case 'LOAD_CODE':\n      return {\n        ...state,\n        code: action.code\n      }\n    default:\n      return state\n  }\n}\n\nexport default appReducer","\nexport const TILE_SIZE = 32;\nexport const MAX_VELOCITY = 20;\nexport const TOP = 'top';\nexport const BOTTOM = 'bottom';\nexport const LEFT = 'left';\nexport const RIGHT = 'right';","import uniqid from 'uniqid';\nimport {matches, mergeWith, merge} from 'lodash';\nimport {MAX_VELOCITY, TILE_SIZE} from '../Game/constants.js';\n\nexport const createNewSprite = (name, x, y, letter)=> ({\n  name: name,\n  letter: letter,\n  position: {x, y},\n  rotation: 0,\n  prevPosition: {x, y},\n  velocity: {x: 0, y: 0},\n  maxVelocity: {x: MAX_VELOCITY, y: MAX_VELOCITY},\n  acceleration: {x: 0, y: 0},\n  friction: 0.15,\n  colliding: {\n    top: [],\n    bottom: [],\n    left: [],\n    right: []\n  },\n  positioning: {\n    top: [],\n    bottom: [],\n    left: [],\n    right: []\n  },\n  static: false,\n  inputs: {}\n});\n\n// also removes a single space on the outside of the bracket (if one exists)\n// otherwise it's possible to end up with multiple spaces where brackets stack\n// eg: '{ velocity: { y: -150 } }'   *could become*   ' velocity: { y: -150  }'\nexport const trimBrackets = (rawString)=> {\n  const string = rawString.trim()\n  let leftBracket\n  let rightBracket\n\n  if (isObject(string)) {\n    leftBracket = '{'\n    rightBracket = '}'\n  }\n  else if (isList(string)) {\n    leftBracket = '['\n    rightBracket = ']'\n  }\n  else {\n    return rawString\n  }\n\n  const openIndex = string.indexOf(leftBracket);\n  const closeIndex = string.lastIndexOf(rightBracket);\n  \n  return string.substr(openIndex + 1, closeIndex - 1).trim();\n}\n\nconst states = {\n  UP: {acceleration: {y: -1}},\n  DOWN: {acceleration: {y: 1}},\n  LEFT: {acceleration: {x: -1}},\n  RIGHT: {acceleration: {x: 1}},\n  FAST_UP: {acceleration: {y: -6}},\n  FAST_DOWN: {acceleration: {y: 6}},\n  FAST_LEFT: {acceleration: {x: -6}},\n  FAST_RIGHT: {acceleration: {x: 6}},\n  SLOW_UP: {acceleration: {y: -0.5}},\n  SLOW_DOWN: {acceleration: {y: 0.5}},\n  SLOW_LEFT: {acceleration: {x: -0.5}},\n  SLOW_RIGHT: {acceleration: {x: 0.5}},\n  JUMP: {velocity: {y: -150}},\n  FLIP: {flip: true},\n  MIRROR: {mirror: true},\n  DEAD: {dead: true},\n  STATIC: {static: true},\n  STATIONARY: {velocity: {x: 0, y: 0}},\n  WIN: {win: true},\n  LOSE: {lose: true}\n};\n\nconst inputs = {\n  '<UP>': 'up',\n  '<DOWN>': 'down',\n  '<LEFT>': 'left',\n  '<RIGHT>': 'right',\n  '<ACTION>': 'action1',\n  '<ACTION1>': 'action1',\n  '<ACTION2>': 'action2'\n};\n\nconst getOpposite = (direction)=> {\n  const oppositeMappings = {\n    'left': 'right',\n    'right': 'left',\n    'top': 'bottom',\n    'bottom': 'top',\n    'up': 'down',\n    'down': 'up',\n    'forward': 'backward'\n  }\n\n  return oppositeMappings[direction];\n}\n\nconst directionToSide = (direction)=> {\n  const mappings = {\n    'left': 'left',\n    'right': 'right',\n    'down': 'bottom',\n    'up': 'top'\n  }\n\n  return mappings[direction];\n}\n\n// Recursively finds the colliding state\nconst getCollidingForSide = (\n  side, traverseDirection, states, currentIndex, COLLIDING_OR_POSITIONING\n)=> {\n  const nextIndex = traverseDirection === 'forward' ? currentIndex + 1 : currentIndex - 1;\n  // outside range\n  if (nextIndex < 0 || nextIndex === states.length) {\n    return;\n  }\n\n  const collidesWith = states[nextIndex];\n  if (!collidesWith) {\n    console.error('Expecting there to always be a state here');\n  }\n\n  let state = [{\n    ...collidesWith\n  }];\n\n  const nextColliding = getCollidingForSide(\n    side, traverseDirection, states, nextIndex, COLLIDING_OR_POSITIONING\n  );\n  if (nextColliding) {\n    state[COLLIDING_OR_POSITIONING] = {\n      [side]: nextColliding\n    }  \n  }\n\n  return state;\n}\n\nconst getColliding = (\n  direction, leftStates, leftIndex, COLLIDING_OR_POSITIONING\n)=> {\n  // direction refers to the direction the collision rule is applied in.\n  // getCollidingForSide('bottom', 'forward' ... refers to searching for the\n  // colliding state for the bottom side by traversing the ruleString to the\n  // right (forward)\n  let colliding = {};\n  const frontSide = directionToSide(direction);\n  const backSide = getOpposite(frontSide);\n  const frontColliding = getCollidingForSide(\n    frontSide, 'forward', leftStates, leftIndex, COLLIDING_OR_POSITIONING\n  );\n  const backColliding = getCollidingForSide(\n    backSide, 'backward', leftStates, leftIndex, COLLIDING_OR_POSITIONING\n  );\n\n  if (backColliding) {\n    colliding[backSide] = backColliding;\n  }\n\n  if (frontColliding) {\n    colliding[frontSide] = frontColliding;\n  }\n\n  if (frontColliding || backColliding) {\n    return colliding; \n  }\n  else {\n    return;\n  }\n}\n\n/*\nStarts withObject.keys( ).length > 0 ? colliding : undefined;\n  [ UP Player | Spike ] -> [ DEAD Player | Spike ]\nBreaks up into 2 rules\n  [ UP Player] -> [ DEAD Player]\n  [ Spike ] -> [ Spike ]\nEvaluate both rules into a pair of state transitions\n[\n  {name: \"Player\", acceleration: {x: 1, y: 0}},\n  {name: \"Player\", dead: true}\n]\n[\n  {name: \"Spike\"},\n  {name: \"Spike\"}\n]\n// Finally adds a colliding property to the left side each state transition\n[\n  {\n    name: \"Player\", acceleration: {x: 1, y: 0},\n    colliding: {\n      top: {name:'Spike'}, bottom: {name:'Spike'},\n      left: {name:'Spike'}, right: {name:'Spike'}\n    }\n  },\n  {name: \"Player\", dead: true}\n]\n[\n  {\n    name: \"Spike\",\n    colliding: {\n      top: {name:'Player'}, bottom: {name:'Player'},\n      left: {name:'Player'}, right: {name:'Player'}\n    }\n  }\n  {name: \"Spike\"}\n]\n*/\nexport const collisionRuleStringToState = (ruleString, names)=> {\n  // Get collision direction (first word at the start of the line)\n  const [firstWord] = ruleString.match(/^([A-Z]+)\\b/);\n  const direction = firstWord.toLowerCase();\n\n\n  // Get the left and right matches\n  const [left, right] = ruleString.replace(firstWord, '').split('->');\n\n  let separator;\n  if (left.includes(' > ')) {\n    separator = '>'\n  }\n  else if (left.includes(' < ')) {\n    separator = '<'\n  }\n  else {\n    separator = '|'\n  }\n\n  const COLLIDING_OR_POSITIONING = separator === '|' ? 'colliding' : 'positioning'\n\n  // <------- leftWordArrays ----->    <--- rightWordArrays -->\n  // <---words--> < ----words----->    <-words-> <---words---->\n  // [ UP Player | Goomba | Brick ] -> [ Player | DEAD Goomba ]\n\n  const leftWordGroupArrays = trimBrackets(left).split(separator)\n    .map((string)=> stringToWordGroups(string))\n\n  const rightWordGroupArrays = trimBrackets(right)\n    .split(separator)\n    .map((string)=> stringToWordGroups(string))\n\n  let leftStates = [];\n  let rightStates = [];\n\n  // Left\n  // The left side is what the rule is looking to match.\n  // The colliding state should recursively nest colliding states if the rule\n  // has multiple collisions\n  for (const words of leftWordGroupArrays) {\n    const state = {\n      ...wordsToState(words, names)\n    }\n\n    leftStates.push(state);\n  }\n\n  const leftStatesWithColliding = leftStates.map((state, index)=> {\n    const colliding = getColliding(\n      direction, leftStates, index, COLLIDING_OR_POSITIONING\n    );\n  \n\n    if (colliding) {\n      return {\n        ...state,\n        [COLLIDING_OR_POSITIONING]: getColliding(\n          direction, leftStates, index, COLLIDING_OR_POSITIONING\n        ),\n      }\n    }\n    else {\n      return state;\n    }\n  });\n\n  // Right\n  // The right state is any changes to the left state. And includes the creation\n  // of completely new state.\n  let rightIndex = 0;\n  for (const words of rightWordGroupArrays) {\n    const matchingLeft = leftWordGroupArrays[rightIndex]\n    let state = {};\n    if (matchingLeft) {\n      // If there's a matching left state, then this state is a transition of that\n      // state. It may be a small change like adding DEAD to a Player.\n      // Eg: [ Mario | Goomba ] -> [ DEAD Mario | Goomba ]\n      \n      // Flatten and merge all the states together into a single state object\n      const states = words.map((string)=> stringToState(string, names))\n      for (const subState of states) {\n        merge(state, subState);\n      }\n    }\n    else {\n      // If there is no matching let state, then this is a completely new state.\n      // Eg: the fireball in this rule: [ <ACTION> Mario ] -> [ Mario | Fireball ]\n      const newSprite = createNewSprite('TEMP_NAME', 0, 0, 'X');\n      state = {\n        ...newSprite,\n        // indicates to applyRules not to merge this but create new state\n        createNew: {direction},\n        ...wordsToState(words, names)\n        // I don't think the right side needs the colliding state calculated\n      }\n\n      // Duplicate the leftmost match state as the match for this new state\n      leftStatesWithColliding.push({...leftStates[0]});\n    }\n\n    rightStates.push(state);\n    rightIndex += 1;\n  }\n\n  // State pairs to state transitions\n  return leftStatesWithColliding.map((leftState, index)=> [leftState, rightStates[index]]);\n\n  // const leftStateA = wordsToState(leftWordsA, names);\n  // const leftStateB = leftWordsB\n  //   ? wordsToState(leftWordsB, names)\n  //   : newSprite()\n    \n  // const rightStateA = wordsToState(rightWordsA, names);\n\n  // // User may omit rightWordsB. In which case populate it with leftWordsB\n  // // Eg: [ <ACTION> Player | Ground ] -> [ JUMP Player ]\n  // // Becomes: [ <ACTION> Player | Ground ] -> [ JUMP Player ]\n  // const rightStateB = wordsToState(rightWordsB ? rightWordsB : leftWordsB, names);\n\n  // // Pay close attention to the flipping of A and B for certain variables.\n  // // collidingA is used as the colliding state for spriteB and vice-a-versa\n  // let collidingA = {};\n  // collidingA[getOpposite(directionToSide(direction))] = [{...leftStateA}]\n\n  // let collidingB = {};\n  // collidingB[directionToSide(direction)] = [{...leftStateB}]\n\n  // const pairA = [\n  //   {...leftStateA, colliding: collidingB},\n  //   rightStateA\n  // ];\n  // const pairB = [\n  //   {...leftStateB, colliding: {...collidingA}},\n  //   rightStateB\n  // ];\n\n  // return [pairA, pairB];\n}\n\nconst negative = (state)=> {\n  const newState = {...state}\n  for (const key of Object.keys(newState)) {\n    newState[key] = !newState[key]\n  }\n\n  return newState\n}\n\nconst wordsToState = (words, names)=> {\n  /* Turn those words into arrays of key value objects\n    [\n      [{name: \"Goomba\"}],\n      [{name: \"Goomba\"}, {acceleration: {x: 1}}]},\n      [{name: \"Goomba\"}, {acceleration: {y: 1}}]}\n    ]\n  */\n  const statesArr = words.map((word)=> {\n    if (names[word]) {\n      return ({\n        name: word\n      });\n    }\n    if (inputs[word]) {\n      return ({\n        inputs: {[inputs[word]]: true}\n      });\n    }\n    if (states[word]) {\n      return ({\n        ...states[word]\n      })\n    }\n\n\n    // remove ! operator\n    // run wordToState on remaining word\n    // apply negative to resulting state\n    // return negative state\n    if (isOperator(word)) {\n      const [operator, right] = word.split('!')\n      \n      return negative(\n        wordsToState([right.trim()], names)\n      )\n    }\n\n    if (word.includes(':')) {\n      const [left, right] = word.split(':')\n\n      // Number\n      const number = Number(right.trim())\n      if (typeof number === 'number' && !isNaN(number)) {\n        return {[left]: number}\n      }\n\n      // Object\n      const rightState = wordsToState([right.trim()], names)\n      return {[left]: {...rightState}}\n    }\n\n    return {};\n  });\n\n  /* Flatten and merge all the states together into a single state object:\n    {name: \"Goomba\", acceleration: {x: 1, y: 1}}\n  */\n  let resultState = {};\n  for (const stateObj of statesArr) {\n    merge(resultState, stateObj);\n  }\n\n  return resultState;\n};\n\nconst propertyRegex = /^\\b[a-z_]+\\b\\s{0,1}[:]/i // property can't have space before colon\n// word can still match on ':', so must come after property\nconst wordRegex = /^[<!]{0,1}[a-z_]+[0-9a-z_]*[>]{0,1}/i\nconst objectRegex = /^\\{/i // simply checks if string starts with '{'\nconst listRegex = /^\\[/i // simply checks if string starts with '{'\nconst numberRegex = /^[-]{0,1}[0-9]*[.]{0,1}[0-9]+/\nconst operatorRegex = /^[!]{1}/ // only supports ! currently\n\nconst isWord = (string)=> Boolean(string.match(wordRegex))\nconst isProperty = (string)=> Boolean(string.match(propertyRegex))\nconst isObject = (string)=> Boolean(string.match(objectRegex))\nconst isList = (string)=> Boolean(string.match(listRegex))\nconst isNumberString = (string)=> Boolean(string.match(numberRegex))\nconst isOperator = (string)=> Boolean(string.match(operatorRegex))\n\nconst splitOnProperty = (string)=> {\n  const [property] = string.match(propertyRegex)\n  const name = property.trim().replace(':', '')\n  const right = string.replace(property, '').trim()\n  \n  let numOpenBrackets = 0\n  for (var i = 0; i < right.length; i++) {\n    const char = right.charAt(i)\n\n    if (numOpenBrackets < 0) {\n      console.error('more closing brackets than opening brackets')\n    }\n\n    if (char === '{') {\n      numOpenBrackets++\n    }\n    else if (char === '}') {\n      numOpenBrackets--\n    }\n    else if (char === ' ' && numOpenBrackets === 0) {\n      const value = right.slice(0, i + 1).trim()\n      const remainder = right.slice(i + 1).trim()\n      \n      return [\n        `${name}: ${value}`,\n        remainder\n      ]\n    }\n  }\n\n  if (numOpenBrackets !== 0) {\n    console.error('unclosed brackets')\n  }\n  \n  // Made it to the end:\n  // value is entire string, no remainder\n  return  [`${name}: ${right}`, '']\n}\n\nconst splitOnObject = (string)=> {\n  let numOpenBrackets = 0\n  for (var i = 0; i < string.length; i++) {\n    const char = string.charAt(i)\n\n    if (numOpenBrackets < 0) {\n      console.error('more closing brackets than opening brackets')\n    }\n\n    if (char === '{') {\n      numOpenBrackets++\n    }\n    else if (char === '}') {\n      numOpenBrackets--\n    }\n    else if (char === ' ' && numOpenBrackets === 0) {\n      const objectString = string.slice(0, i + 1).trim()\n      const remainder = string.slice(i + 1).trim()\n\n      return [\n        objectString,\n        remainder\n      ]\n    }\n  }\n\n  if (numOpenBrackets !== 0) {\n    console.error('unclosed brackets')\n  }\n  \n  // Made it to the end:\n  // value is entire string, no remainder\n  return  [string, '']\n}\n\nconst splitOnFirstWordGroup = (rawString)=> {\n  const string = rawString.trim()\n\n  // if (isOperator(string)) {\n  //   return splitOnOperator(string)\n  // }\n\n  if (isObject(string)) {\n    return splitOnObject(string)\n  }\n\n  if (isProperty(string)) {\n    return splitOnProperty(string)\n  }\n\n  if (isWord(string)) {\n    const [word] = string.match(wordRegex)\n\n    return [word.trim(), string.replace(word, '')]\n  }\n\n  if (isNumberString(string)) {\n    const [numberString] = string.match(numberRegex)\n\n    return [numberString, string.replace(numberString, '')]\n  }\n\n  console.error('made it to the end without returning anything:', string)\n}\n\nconst stringToWordGroups = (string)=> {  \n  const [left, rest] = splitOnFirstWordGroup(string)\n\n  if (rest.length === 0) {\n    return [left]\n  }\n\n  return [left, ...stringToWordGroups(rest)]\n}\n\nconst propertyToState = (property, names)=> {\n  const firstColonRegex = /:(.+)/ \n  // the (.+) in the regex is to ensure the rest of the string is included in the 2nd arg\n  // without it, the string will split on every colon, not just the first\n  const [name, right] = property.split(firstColonRegex)\n  \n  if (isObject(right.trim())) {\n    const trimmed = trimBrackets(right.trim())\n    const innerState = stringToState(trimmed, names)\n    \n    return {\n      [name]: {...innerState},\n    }\n  }\n  else {\n    const valueState = stringToState(right.trim(), names)\n\n    return {\n      [name]: valueState,\n    }\n  }\n}\n\n// input: '{ Player carrying: Brick }'\n// output: { name: 'Player', carrying: {name: 'Brick'} }\nconst stringToState = (string, names)=> {\n  const wordGroups = stringToWordGroups(string)\n\n  if (wordGroups.length === 0) {\n    console.error('No word groups')\n  }\n  else if (wordGroups.length === 1) {\n    const [group] = wordGroups\n\n    // Property\n    if (isProperty(group)) {\n      return propertyToState(group, names)\n    }\n\n    // Expandable keyword\n    if (isWord(group)) {\n      return wordsToState([group], names)\n    }\n\n    if (isNumberString(group)) {\n      return parseFloat(group)\n    }\n\n    console.error('not dealing with:', wordGroups)\n    return {}\n  }\n\n  let states = []\n  for (const group of wordGroups) {\n    states.push(stringToState(group, names))\n  }\n\n  // Flatten and merge all the states together into a single state object\n  let resultState = {};\n  for (const state of states) {\n    merge(resultState, state);\n  }\n\n  return resultState\n}\n\n// { Player } -> { Player carrying: Brick }\nexport const ruleStringToState = (ruleString, names)=> {\n  const [left, right] = ruleString.split('->')\n\n  return [\n    stringToState(trimBrackets(left), names),\n    stringToState(trimBrackets(right), names)\n  ]\n}\n\nconst addVectors = (vectorA, vectorB)=> ({\n  x: vectorA.x + vectorB.x,\n  y: vectorA.y + vectorB.y\n});\n\nconst getDirectionOffset = (direction)=> {\n  const directionOffsetsMap = {\n    up: {x: 0, y: -TILE_SIZE},\n    down: {x: 0, y: TILE_SIZE},\n    left: {x: -TILE_SIZE, y: 0},\n    right: {x: TILE_SIZE, y: 0}\n  }\n\n  return directionOffsetsMap[direction];\n}\n\nexport const getNewStateToAdd = (sprites, transitions)=> {\n  const newState = [];\n\n  for (const sprite of sprites) {\n    for (const transition of transitions) {\n      const [left, right] = transition;\n\n      if (matches(left)(sprite)) {\n        // Add new sprite + give it a unique ID\n        newState.push({\n          ...right,\n          id: uniqid(),\n          position: addVectors(sprite.position, getDirectionOffset(right.createNew.direction)),\n          createNew: undefined\n        });\n      }\n    }\n  }\n\n  return newState;\n}\n\nexport const addNewState = (sprites, newState)=> {\n  return [\n    ...sprites,\n    ...newState\n  ]\n}\n\n// custom merge rules\n// const mergeCustomizer = (objValue, srcValue)=> {\n//   if (isNumber(objValue)) {\n//     return objValue + srcValue;\n//   }\n// }\n\nexport const getStateTransitions = (rules, sprites)=> {\n  if (rules.length === 0) {\n    return []\n  }\n\n  const transitions = {}\n  for (const sprite of sprites) {\n    for (const rule of rules) {\n      const [left, right] = rule;\n      if (matches(left)(sprite)) {\n        if (!transitions[sprite.id]) {\n          transitions[sprite.id] = []\n        }\n        \n        transitions[sprite.id].push(right)\n      }\n    }\n  }\n\n  return transitions\n};\n\nexport const applyStateTransitions = (transitions, sprites)=> {\n  return sprites.map((sprite)=> {\n    const newStates = transitions[sprite.id]\n    if (newStates) {\n      let result = {...sprite}\n      for (const state of newStates) {\n        result = mergeWith(sprite, state)\n      }\n\n      return result\n    }\n\n    return sprite\n  })\n};\n\nexport const isAlive = (sprite)=> !sprite.dead;\nexport const isCreateNewState = (rule)=> {\n  const [, right] = rule;\n  return right.createNew !== undefined;\n};\n\nexport const flashDead = (sprite)=> {\n  if (!sprite.dead) {\n    return sprite\n  }\n\n  return {\n    ...sprite,\n    // color: '#ffffff'\n    flash: true\n  }\n}\n\nexport const flagDeadForRemoval = (sprite)=> {\n  if (!sprite.dead) {\n    return sprite\n  }\n\n  return {\n    ...sprite,\n    remove: true\n  }\n}","import {createNewSprite, trimBrackets} from './state.js'\nimport {flatten} from 'lodash'\nimport {TILE_SIZE} from '../Game/constants.js'\nimport uniqid from 'uniqid'\nimport {ruleStringToState, collisionRuleStringToState, isCreateNewState} from '../util/state.js'\n\nconst isCollisionRule = (line)=>\n  line.includes('|') || line.includes(' >') || line.includes(' <')\nconst isRule = (line)=> line.includes('->') && !isCollisionRule(line)\nconst isLevel = (line)=> line.match(/#.+#/g)\nexport const isLegend = (line)=> line.includes('=')\nconst isObject = (line)=> line.match(/=[ ]{0,1}\\{/g)\nconst isList = (line)=> line.match(/=[ ]{0,1}\\[/g)\n\nexport const parseLegend = (code)=> {\n  let legend = {}\n\n  code.split('\\n')\n    .filter(isLegend)\n    .forEach((line)=> {\n      const [symbol, right] = line.split('=').map((str)=> str.trim());\n      const names = right.split(' or ')\n      // this is a function to allow returning a random name in the case of:\n      // G = Goomba or Tree or Brick\n      legend[symbol] = ()=> {\n        const randIndex = Math.floor(Math.random() * names.length)\n        return names[randIndex]\n      }\n    });\n\n  return legend\n};\n\nconst removeLevelEdges = (lines)=> (\n  lines.slice(1, -1).map((line)=> line.slice(1, -1))\n);\n\nexport const parseLevel = (code)=> (\n  code.split('\\n').filter(isLevel) |> removeLevelEdges\n);\n\nexport const parseNames = (code)=> {\n  const lines = code.split('\\n').filter(isLegend);\n  const names = lines.map((line)=> {\n    const [, right] = line.split(' = ');\n    const words = right.split(' or ');\n    \n    return words;\n  });\n\n  return flatten(names);\n};\n\n/*\nTakes a variable declaration line as input\nReturns an object with key as variable name and value as list containing the states/s\nfor that variable\nVariable example:\n  'RIGHTIO: { velocity: { x: 1 } }'\n  {RIGHTIO: ['velocity: { x: 1 }']}\nList example:\n  'MY_LIST = [ Goomba Player Squid ]'\n  {MY_LIST: ['Goomba', 'Player', 'Squid']}\n\n*/\nexport const parseObjects = (code)=> {\n  const lines = code.split('\\n').filter(isObject)\n\n  let results = {}\n  for (const line of lines) {\n    const [name, expansion] = line.split(' = ')\n    \n    results[name] = [trimBrackets(expansion)]\n  }\n\n  return results\n}\n\nexport const parseLists = (code)=> {\n  const lines = code.split('\\n').filter(isList)\n\n  let results = {}\n  for (const line of lines) {\n    const [name, list] = line.split(' = ')\n    const expansions = trimBrackets(list).split(' ')\n    \n    results[name] = expansions\n  }\n\n  return results\n}\n\nexport const getLevelDimensions = (level)=> {\n  const width_in_tiles = level[0].length;\n  const height_in_tiles = level.length;\n  \n  return [width_in_tiles, height_in_tiles];\n}\n\nexport const parseSprites = (level, legend)=> {\n  const sprites = [];\n  level.map((line, row)=> line.split('').forEach((char, col)=> {\n    const getName = legend[char];\n    if (getName && getName() !== 'Empty') {\n      const x = col * TILE_SIZE;\n      const y = row * TILE_SIZE;\n      sprites.push(\n        {\n          id: uniqid(),\n          ...createNewSprite(getName(), x, y, char)\n        }\n      );\n    }\n  }));\n\n  return sprites;\n};\n\nexport const standardExpansions = {\n  ALL: ['UP', 'DOWN', 'LEFT', 'RIGHT'],\n  MOVE: ['UP', 'DOWN', 'LEFT', 'RIGHT'],\n  SLOW_MOVE: ['SLOW_UP', 'SLOW_DOWN', 'SLOW_LEFT', 'SLOW_RIGHT'],\n  HORIZONTAL: ['LEFT', 'RIGHT'],\n  VERTICAL: ['UP', 'DOWN']\n}\n\n// replaces all occurrances of a word in a string with the given word\nconst replaceWord = (line, word, newWord)=> {\n  const newLine = line.replace(word, newWord)\n\n  // if more occurances of the word, then run replaceWord again\n  if (newLine.includes(word)) {\n    return replaceWord(newLine, word, newWord)\n  }\n\n  return newLine\n}\n\n/*\ntakes a single rule and expands it into several\nEg:\n  ALL [Player] -> [Player]\nBecomes:\n  UP [Player] -> [Player]\n  DOWN [Player] -> [Player]\n  LEFT [Player] -> [Player]\n  RIGHT [Player] -> [Player]\n */\nconst expandRule = (line, expansions)=> {\n  const lines = []\n  \n  for (const [key, words] of Object.entries(expansions)) {\n    if (line.includes(key)) {\n      for (const word of words) {\n        lines.push(\n          replaceWord(line, key, word)\n        );\n      }\n\n      // Return early once one keyword is dealt with\n      return lines;\n      /*\n      It's important to return early here once a keyword is found to prevent\n      this function from dealing with more than one keyword per execution\n      For example if a line contains both ALL and HORIZONTAL\n      Only one keyword can be dealt with per pass, else we end up with an output like:\n      UP [ _ ] -> [ HORIZONTAL ]\n      DOWN [ _ ] -> [ HORIZONTAL ]\n      LEFT [ _ ] -> [ HORIZONTAL ]\n      RIGHT [ _ ] -> [ HORIZONTAL ]\n      ALL [ _ ] -> [ LEFT ]\n      ALL [ _ ] -> [ RIGHT ]\n      Once the above expanded again, we would end up with a bunch of duplicate rules\n      */\n    }\n  }\n\n  return lines;\n}\n\nconst isExpandable = (line, expansions)=> {\n  for (const key of Object.keys(expansions)) {\n    if (line.includes(key)) {\n      return true\n    }\n  }\n\n  return false\n}\n\nexport const expandRules = (lines, expansions)=> {\n  const notExpandable = lines.filter((line)=> !isExpandable(line, expansions))\n  const expanded = flatten(\n    lines.filter((line)=> isExpandable(line, expansions))\n      .map((line)=> expandRule(line, expansions))\n  )\n\n  if (expanded.length === 0) {\n    // fully expanded, stop recursing\n    return lines\n  }\n  \n  return [\n    ...notExpandable,\n    ...expandRules(expanded, expansions)\n  ]\n}\n\n// If no direction given, then append 'ALL'. Otherwise use the given direction ('UP', 'DOWN', etc)\nexport const addImplicitKeywords = (line) => {\n  const [firstWord] = line.split('{');\n  \n  let appendedLine = line;\n  if (firstWord === '') {\n    appendedLine = line.replace('{', 'ALL {');\n  }\n\n  return appendedLine;\n}\n\nexport const parseRules = (code, names, variables)=> {\n  const customExpansions = variables\n  const expansions = {...customExpansions, ...standardExpansions}\n  \n  const regularRules = code\n    .split('\\n')\n    .filter(isRule)\n    |> ((ruleStrings)=> expandRules(ruleStrings, expansions))\n    |> ((ruleStrings)=> ruleStrings.map((string)=> ruleStringToState(string, names)))\n\n  const collisionRules = code\n    .split('\\n')\n    .filter(isCollisionRule)\n    .map(addImplicitKeywords)\n    |> ((ruleStrings)=> expandRules(ruleStrings, expansions))\n    |> ((ruleStrings)=> ruleStrings.map((string)=> collisionRuleStringToState(string, names)))\n    |> flatten\n  \n  // separate the collisionRules into 2 groups: \n  // those that will spawn new state\n  // and those that will modify existing state\n  const collisionCreate = collisionRules.filter(isCreateNewState);\n  const collisionModify = collisionRules.filter((rule)=> !isCreateNewState(rule));\n\n  return {\n    modify: [...regularRules, ...collisionModify],\n    create: collisionCreate\n  }\n}","import {\n  TILE_SIZE,\n  TOP, BOTTOM, LEFT, RIGHT\n} from './constants.js'\n\nexport const roundToPixels = (sprite)=> ({\n  ...sprite,\n  position: {\n    x: Math.round(sprite.position.x),\n    y: Math.round(sprite.position.y),\n  }\n});\n\nconst getEdges = (sprite)=> ({\n  top: sprite.position.y,\n  bottom: sprite.position.y + TILE_SIZE,\n  left: sprite.position.x,\n  right: sprite.position.x + TILE_SIZE\n});\n\nconst isOverlapping = (spriteA, spriteB)=> {\n  const a = getEdges(spriteA);\n  const b = getEdges(spriteB);\n  \n  return (\n    a.bottom > b.top &&\n    a.top < b.bottom &&\n    a.right > b.left &&\n    a.left < b.right\n  );\n};\n\nconst getPointsForSide = (side, sprite)=> {\n  // INSET is to prevent situations such as both TOP and LEFT/RIGHT colliding when 2 sprites are standing\n  // next to each other.\n  // It's not ideal because it means you do things like stand on a sprite just on the very outmost edge\n  // without triggering any UP DOWN collisions.\n  const INSET = 5;\n\n  if (side === LEFT) {\n    return [\n      {x: sprite.position.x, y: sprite.position.y + INSET},\n      {x: sprite.position.x, y: sprite.position.y + TILE_SIZE - INSET}\n    ]\n  }\n  if (side === RIGHT) {\n    return [\n      {x: sprite.position.x + TILE_SIZE, y: sprite.position.y + INSET},\n      {x: sprite.position.x + TILE_SIZE, y: sprite.position.y + TILE_SIZE - INSET}\n    ]\n  }\n  if (side === TOP) {\n    return [\n      {x: sprite.position.x + INSET, y: sprite.position.y},\n      {x: sprite.position.x + TILE_SIZE - INSET, y: sprite.position.y}\n    ]\n  }\n  if (side === BOTTOM) {\n    return [\n      {x: sprite.position.x + INSET, y: sprite.position.y + TILE_SIZE},\n      {x: sprite.position.x + TILE_SIZE - INSET, y: sprite.position.y + TILE_SIZE}\n    ]\n  }\n}\n\nconst overlapsPoint = (point, spriteB, padding = 0)=> {\n  const {x, y} = point;\n  const {top, bottom, left, right} = getEdges(spriteB);\n  return (\n    y > top - padding &&\n    y < bottom + padding &&\n    x > left - padding &&\n    x < right + padding\n  );\n}\n\nconst overlapsSide = (side, spriteA, spriteB)=> {\n  const points = getPointsForSide(side, spriteA);\n\n  for (const point of points) {\n    if (overlapsPoint(point, spriteB, 1)) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\nconst getCollidedEdges = (spriteA, spriteB)=> {\n  const prevEdgesA = getEdges({position: {...spriteA.prevPosition}});\n  const prevEdgesB = getEdges({position: {...spriteB.prevPosition}});\n  const collidedEdges = {top: false, bottom: false, left: false, right: false};\n\n  // by checking if an edge was not overlapping last frame but is this frame\n  // we can see which edge is colliding\n  if (prevEdgesA.top >= prevEdgesB.bottom) {\n    collidedEdges[TOP] = true;\n  }\n  else if (prevEdgesA.bottom <= prevEdgesB.top) {\n    collidedEdges[BOTTOM] = true;\n  }\n\n  if (prevEdgesA.left >= prevEdgesB.right) {\n    collidedEdges[LEFT] = true;\n  }\n  else if (prevEdgesA.right <= prevEdgesB.left) {\n    collidedEdges[RIGHT] = true;\n  }\n\n  return collidedEdges;\n}\n\nconst getAxisFromEdge = (edge)=> {\n  const edgeAxisMap = {\n    left: 'x',\n    right: 'x',\n    top: 'y',\n    bottom: 'y'\n  };\n\n  return edgeAxisMap[edge];\n}\n\nconst getSeparatedState = (edgeA, spriteA, spriteB)=> {\n  const edgesB = getEdges(spriteB);\n  const velocity = {...spriteA.velocity, [getAxisFromEdge(edgeA)]: 0};\n\n  let position = {...spriteA.position};\n  if (edgeA === TOP) {\n    position.y = edgesB[BOTTOM];\n  }\n  else if (edgeA === BOTTOM) {\n    position.y = edgesB[TOP] - TILE_SIZE;\n  }\n  else if (edgeA === LEFT) {\n    position.x = edgesB[RIGHT];\n  }\n  else if (edgeA === RIGHT) {\n    position.x = edgesB[LEFT] - TILE_SIZE;\n  }\n\n  return {position, velocity};\n}\n\nexport const updateSpriteCollidingState = (spriteA, sprites, width, height)=> {\n  if (spriteA.static) {\n    return spriteA;\n  }\n\n  let colliding = {...spriteA.colliding};\n\n  // sprites\n  for (const spriteB of sprites) {\n    if (spriteA.id === spriteB.id) {\n      continue;\n    }\n\n    for (const edge of [TOP, BOTTOM, LEFT, RIGHT]) {\n      if (overlapsSide(edge, spriteA, spriteB)) {\n        \n        const collidingSprite = {...spriteB}\n        // prevent recursion of colliding state by removing the colliding state from spriteB\n        // otherwise it can recurse forever: state.colliding.bottom.colliding.top.colliding.bottom...\n        collidingSprite.colliding = undefined\n\n        colliding[edge].push(collidingSprite)\n      }\n    }\n  }\n\n  // walls\n  const padding = 1;\n  if (spriteA.position.x < 0 + padding) {\n    colliding[LEFT].push({name: 'Wall'});\n  }\n  if (spriteA.position.x > width - TILE_SIZE - padding) {\n    colliding[RIGHT].push({name: 'Wall'});\n  }\n  if (spriteA.position.y < 0 + padding) {\n    colliding[TOP].push({name: 'Wall'});\n  }\n  if (spriteA.position.y > height - TILE_SIZE - padding) {\n    colliding[BOTTOM].push({name: 'Wall'});\n  }\n\n  return {...spriteA, colliding};\n};\n\nexport const updateSpritePositioningState = (spriteA, sprites)=> {\n  if (spriteA.static) {\n    return spriteA;\n  }\n\n  let positioning = {...spriteA.positioning};\n\n  // sprites\n  for (const spriteB of sprites) {\n    if (spriteA.id === spriteB.id) {\n      continue;\n    }\n\n    // prevent recursion of positioning state by removing the positioning state from spriteB\n    // otherwise it can recurse forever: state.positioning.bottom.positioning.top.positioning.bottom...\n    const removePositioningState = (spriteB)=> ({\n      ...spriteB, positioning: undefined\n    })\n\n    if (spriteA.position.x < spriteB.position.x) {\n      positioning.right.push(removePositioningState(spriteB))\n    }\n    else {\n      positioning.left.push(removePositioningState(spriteB))\n    }\n\n    if (spriteA.position.y < spriteB.position.y) {\n      positioning.bottom.push(removePositioningState(spriteB))\n    }\n    else {\n      positioning.top.push(removePositioningState(spriteB))\n    }\n  }\n\n  return {...spriteA, positioning};\n};\n\nexport const applySpriteCollisions = (spriteA, sprites)=> {\n  if (spriteA.static) {\n    return spriteA;\n  }\n\n  for (const spriteB of sprites) {\n    if (spriteA.id === spriteB.id) {\n      continue;\n    }\n\n    if (isOverlapping(spriteA, spriteB)) {    \n      const collidedEdges = getCollidedEdges(spriteA, spriteB);\n      let newSpriteA = {...spriteA};\n      \n      if (collidedEdges[TOP]) {\n        newSpriteA = {\n          ...newSpriteA,\n          ...getSeparatedState(TOP, spriteA, spriteB)\n        }\n      }\n      else if (collidedEdges[BOTTOM]) {\n        newSpriteA = {\n          ...newSpriteA,\n          ...getSeparatedState(BOTTOM, spriteA, spriteB)\n        }\n      }\n\n      // Check if overlap has been resolved before resolving horizontal collisions\n      // This is a cheap trick to prevent sprite from catching on the corners\n      // of adjacent tiles (vertical is resolved first & the horizontal is avoided)\n      if (isOverlapping(newSpriteA, spriteB)) {\n        if (collidedEdges[LEFT]) {\n          newSpriteA = {\n            ...newSpriteA,\n            ...getSeparatedState(LEFT, spriteA, spriteB)\n          }\n        }\n        else if (collidedEdges[RIGHT]) {\n          newSpriteA = {\n            ...newSpriteA,\n            ...getSeparatedState(RIGHT, spriteA, spriteB)\n          }\n        }\n      }\n      \n      return newSpriteA;\n    }\n  }\n\n  return spriteA;\n};\n\nexport const applyWallCollisions = (sprite, width, height)=> {\n  if (sprite.static) {\n    return sprite\n  }\n\n  const newPosition = {...sprite.position}\n  const newVelocity = {...sprite.velocity}\n\n  if (sprite.position.y > height - TILE_SIZE) {\n    newPosition.y = height - TILE_SIZE\n    newVelocity.y = 0\n  }\n\n  if (sprite.position.y < 0) {\n    newPosition.y = 0\n    newVelocity.y = 0\n  }\n\n  if (sprite.position.x > width - TILE_SIZE) {\n    newPosition.x = width - TILE_SIZE\n    newVelocity.x = 0\n  }\n\n  if (sprite.position.x < 0) {\n    newPosition.x = 0\n    newVelocity.x = 0\n  }\n  \n  return {\n    ...sprite,\n    position: newPosition,\n    velocity: newVelocity\n  }\n}\n\nexport const storePreviousPosition = (sprite)=> ({\n  ...sprite,\n  prevPosition: {...sprite.position}\n});\n\nexport const applyAcceleration = (sprite)=> {\n  const {velocity, maxVelocity, acceleration} = sprite;\n  return {\n    ...sprite,\n    velocity: {\n      x: Math.max(Math.min(velocity.x + acceleration.x, maxVelocity.x), -maxVelocity.x),\n      y: Math.max(Math.min(velocity.y + acceleration.y, maxVelocity.y), -maxVelocity.y)\n    },\n    acceleration: {x: 0, y: 0}\n  }\n};\n\nexport const applyVelocity = (sprite)=> ({\n  ...sprite,\n  position: {\n    x: sprite.position.x + sprite.velocity.x,\n    y: sprite.position.y + sprite.velocity.y\n  }\n});\n\nexport const resetColliding = (sprite)=> ({\n  ...sprite,\n  colliding: {top: [], bottom: [], left: [], right: []},\n\n});\n\nexport const resetPositioning = (sprite)=> ({\n  ...sprite,\n  positioning: {top: [], bottom: [], left: [], right: []},\n\n});\n\nconst snapNearZero = (num)=> Math.abs(num) > 0.0001 ? num : 0\n\nexport const applyFriction = (sprite)=> {\n  const x = sprite.velocity.x * (1 - sprite.friction)\n  const y = sprite.velocity.y * (1 - sprite.friction)\n  \n  // console.log(snapNearZero(x))\n  // console.log(snapNearZero(y))\n\n  return {\n    ...sprite,\n    velocity: {\n      x: snapNearZero(x),\n      y: snapNearZero(y),\n    }\n  }\n};","import {parseRules, parseSprites, parseLegend, parseLevel, parseNames,\n  parseObjects, parseLists, getLevelDimensions} from '../util/parse.js'\nimport {getStateTransitions, isAlive, getNewStateToAdd, addNewState,\n  applyStateTransitions, flagDeadForRemoval, flashDead} from '../util/state.js'\nimport {storePreviousPosition, applyAcceleration, applyVelocity, applyFriction,\n  updateSpriteCollidingState, updateSpritePositioningState,\n  applySpriteCollisions, applyWallCollisions, roundToPixels,\n  resetColliding, resetPositioning\n} from './physics'\nimport {TILE_SIZE} from '../Game/constants.js'\nimport Plain from 'slate-plain-serializer'\nimport uniqid from 'uniqid'\n\nconst defaultState = {\n  currentView: 'game',\n  sprites: [],\n  effects: [],\n  names: {},\n  width_in_tiles: 0,\n  height_in_tiles: 0,\n  debug: false,\n  imageMap: {},\n  rules: {\n    regular: [],\n    create: [],\n    modify: []\n  },\n  stateTransitions: {\n    regular: {}\n  },\n  availableImages: ['Player', 'Brick', 'QuestionBrick', 'Spike', 'Goomba', 'GoombaRed'],\n  freezeFrames: 0,\n  shake: false\n}\n\nconst arrayToObject = (array) =>\n   array.reduce((obj, item) => {\n     obj[item] = true\n     return obj\n   }, {})\n\nconst removeComments = (code)=>\n  code.split('\\n').filter(\n    (line)=> !line.includes('//')\n  ).join('\\n')\n\nconst getNextView = (winners, losers)=> {\n  if (winners.length > 0 || losers.length > 0) {\n    return 'menu'\n  } \n\n  return null\n}\n\nconst gameReducer = (state = defaultState, action) => {\n  switch (action.type) {\n    case 'TOGGLE_DEBUG': {\n      return {\n        ...state,\n        debug: !state.debug\n      }\n    }\n    \n    case 'SET_IMAGE': {\n      const imageMap = {...state.imageMap}\n      const {variableName, imageName} = action\n      imageMap[variableName] = imageName\n      \n      return {\n        ...state,\n        imageMap\n      }\n    }\n    \n    case 'SET_NO_IMAGE': {\n      const imageMap = {...state.imageMap}\n      const {variableName} = action\n      imageMap[variableName] = null\n      // null means the user intended to use ascii\n      // whereas undefined is a lack of choice - we do not know what the user wants\n      // So we can switch on undefined in places to show default images for some\n      // sprites: Player, Goomba etc\n      \n      return {\n        ...state,\n        imageMap\n      }\n    }\n    \n    case 'COMPILE': {\n      try {\n        const {serialize} = Plain\n        const level = action.code |> serialize |> removeComments |> parseLevel\n        const legend = action.code |> serialize |> removeComments |> parseLegend\n        const sprites = parseSprites(level, legend)\n    \n        // Names is the legend mapped to have the values as keys. Used for fast name lookup.\n        // this used to use the legend before the random features were added.\n        // For this to work though, names needs to include all possible names, including those that might not be rendered onto\n        // the map the first time it is loaded. I suppose later on this should also include things spawned within rules that may\n        // not also appear in the legend.\n        // Ideally, I could refactor out this names object entirely. It seems like that should be possible.\n        const namesArr = action.code |> serialize |> parseNames\n        const names = arrayToObject(namesArr)\n        \n        const objects = action.code |> serialize |> parseObjects\n        const lists = action.code |> serialize |> parseLists\n        const variables = {...objects, ...lists}\n\n        // A rule consists of a before and an after state\n        const rules = parseRules(\n          action.code |> serialize |> removeComments,\n          names,\n          variables\n        )\n\n        const [width_in_tiles, height_in_tiles] = getLevelDimensions(level);\n\n        return {\n          ...defaultState,\n          sprites,\n          rules,\n          width: width_in_tiles * TILE_SIZE,\n          height: height_in_tiles * TILE_SIZE,\n          names,\n          imageMap: {...state.imageMap}\n          // imageMap\n        }\n      }\n      catch(err) {\n        console.error(err);\n        return {\n          ...defaultState,\n          error: 'Compilation error '\n        }\n      }\n    }\n\n    case 'UPDATE': {\n      if (state.currentView !== 'game') {\n        return state;\n      }\n\n      // Decrement freezeFrames\n      if (state.freezeFrames > 0) {\n        return {\n          ...state,\n          freezeFrames: state.freezeFrames - 1\n        }\n      }\n\n      const spritesToKeep = state.sprites.filter((sprite)=> !sprite.remove)\n      const effectsToKeep = state.effects.filter((effect)=>\n          effect.progress < effect.duration\n        )\n    \n      // Freeze frames and add effects if something has died\n      const dead = spritesToKeep.filter((sprite)=> isAlive(sprite) === false)\n    \n      if (dead.length > 0) {\n        const newSprites = spritesToKeep\n          |> ((sprites)=> sprites.map(flashDead))\n          |> ((sprites)=> sprites.map(flagDeadForRemoval))\n\n        const newEffects = dead.map((deadSprite)=> ({\n          name: 'explosion',\n          duration: 10, // frames\n          progress: 0, // removed once progress reaches duration\n          id: uniqid(),\n          position: deadSprite.position\n        }))\n\n        return {\n          ...state,\n          sprites: newSprites,\n          freezeFrames: 5,\n          shake: true,\n          effects: [...newEffects, ...effectsToKeep]\n        }\n      }\n\n      const previousState = {...state};\n      const stateToAdd = getNewStateToAdd(spritesToKeep, state.rules.create)\n      \n      const stateTransitions = {\n        modify: getStateTransitions(state.rules.modify, spritesToKeep),\n        create: getStateTransitions(state.rules.create, spritesToKeep),\n      }\n\n      const winners = spritesToKeep.filter((sprite)=> Boolean(sprite.win))\n      const losers = spritesToKeep.filter((sprite)=> Boolean(sprite.lose))\n\n      // Dead sprites aren't removed right away, instead they are flashed\n      // white then flagged for removal.\n      // This allows for them to stay on screen in their flashed state for\n      // the duration of the freezeFrames\n\n      const updatedSprites = spritesToKeep\n        |> ((sprites)=> addNewState(sprites, stateToAdd))\n        |> ((sprites)=> sprites.map(resetColliding))\n        |> ((sprites)=> sprites.map(resetPositioning))\n        |> ((sprites)=> sprites.map((sprite)=> updateSpriteCollidingState(\n          sprite, spritesToKeep, state.width, state.height\n        )))\n        |> ((sprites)=> sprites.map((sprite)=> updateSpritePositioningState(\n          sprite, spritesToKeep\n        )))\n        |> ((sprites)=> sprites.map(storePreviousPosition))\n        |> ((sprites)=> sprites.map(applyFriction))\n        |> ((sprites)=> sprites.map(applyAcceleration))\n        |> ((sprites)=> sprites.map(applyVelocity))\n        |> ((sprites)=> sprites.map((sprite)=> applySpriteCollisions(sprite, spritesToKeep, previousState)))\n        |> ((sprites)=> sprites.map((sprite)=> applySpriteCollisions(sprite, spritesToKeep, previousState)))\n        |> ((sprites)=> sprites.map((sprite)=> applySpriteCollisions(sprite, spritesToKeep, previousState)))\n        |> ((sprites)=> sprites.map((sprite)=> applyWallCollisions(sprite, state.width, state.height)))\n        |> ((sprites)=> sprites.map(roundToPixels))\n        |> ((sprites)=> applyStateTransitions(stateTransitions.modify, sprites))\n        \n      const updatedEffects = effectsToKeep.map((effect)=> ({\n        ...effect,\n        progress: effect.progress + 1\n      }))\n\n      return {\n          ...state,\n          sprites: updatedSprites,\n          stateTransitions,\n          currentView: getNextView(winners, losers) || state.currentView,\n          shake: false,\n          effects: updatedEffects\n      }\n    }\n\n    case 'SET_INPUT': {\n      return {\n        ...state,\n        sprites: state.sprites.map(\n          (sprite)=> ({...sprite, inputs: {...sprite.inputs, [action.input]: true}})\n        )\n      };\n    }\n\n    case 'CANCEL_INPUT': {\n      return {\n        ...state,\n        sprites: state.sprites.map(\n          (sprite)=> {\n            const newInputs = {...sprite.inputs};\n            newInputs[action.input] = undefined;\n            return {...sprite, inputs: newInputs}\n          }\n        )\n      };\n    }\n\n    default: {\n      return state\n    }\n  }\n}\n\nexport default gameReducer","\nconst initialTileSets = [\n  [\n    [0, 1, 1, 0,],\n    [1, 1, 1, 1,],\n    [1, 1, 1, 1,],\n    [0, 1, 1, 0,]\n  ],\n  [\n    [0, 1, 1, 0,],\n    [1, 0, 0, 1,],\n    [1, 0, 0, 1,],\n    [0, 1, 1, 0,]\n  ]\n]\n\nconst tileImages = ['tile0', 'tile1', 'tile2', 'tile3']\n\nconst rasterise = (tileSet)=> {\n  const width = 128\n  const height = 128\n\n  const canvas = document.createElement('canvas')\n  canvas.width = width\n  canvas.height = height\n  \n  let ctx = canvas.getContext('2d')\n  tileSet.forEach((row, rowIndex)=> (\n    tileSet[rowIndex].forEach((col, colIndex)=> {\n      const tileImage = tileImages[tileSet[rowIndex][colIndex]]\n      const image = new Image(32, 32);\n      image.onload = function() {\n          console.log('loaded')\n          ctx.drawImage(image, col * 32, row * 32);\n      };\n      image.src = `../Game/images/tiles/${tileImage}.png`\n      // the src needs to be set after the onload because apparently\n      // sometimes the src can be loaded instantly (eg: if the image is cached)\n    })\n  ))\n\n  // produce png from canvas\n  var dataUri = canvas.toDataURL()\n\n  return dataUri\n}\n\nconst defaultState = {\n  tileSets: initialTileSets,\n  open: false,\n  images: initialTileSets.map((tileSet)=> rasterise(tileSet)),\n  tileImages\n}\n\nconst spriteEditorReducer = (state = defaultState, action) => {\n  switch (action.type) {\n    case 'spriteEditor/SET_OPEN':\n      return {\n        ...state,\n        open: action.open\n      }\n    case 'spriteEditor/UPDATE_TILESETS':\n      return {\n        ...state,\n        tileSets: action.tileSets,\n        images: action.tileSets.map((tileSet)=> rasterise(tileSet))\n      }\n    default:\n      return state\n  }\n}\n\nexport default spriteEditorReducer","import {combineReducers} from 'redux';\nimport appReducer from './App/reducer.js';\nimport gameReducer from './Game/reducer.js';\nimport spriteEditorReducer from './SpriteEditor/reducer.js';\n\nexport default combineReducers({\n  app: appReducer,\n  game: gameReducer,\n  spriteEditor: spriteEditorReducer\n})\n","\nimport * as firebase from 'firebase';\nimport 'firebase/firestore' // Required for side-effects\n\nconst config = {\n  apiKey: \"AIzaSyBHLFHOl9TSm557CTNB0IARouvjID9eVmA\",\n  authDomain: \"micro-gg.firebaseapp.com\",\n  databaseURL: \"https://micro-gg.firebaseio.com\",\n  projectId: \"micro-gg\",\n  storageBucket: \"micro-gg.appspot.com\",\n  messagingSenderId: \"53073229739\"\n}\n\nconst firebaseInitialized = firebase.initializeApp(config)\n\nfirebase.firestore().enablePersistence()\n  .catch(function(err) {\n      if (err.code === 'failed-precondition') {\n          // Multiple tabs open, persistence can only be enabled\n          // in one tab at a a time.\n          // ...\n      } else if (err.code === 'unimplemented') {\n          // The current browser does not support all of the\n          // features required to enable persistence\n          // ...\n      }\n  });\n// Subsequent queries will use persistence, if it was enabled successfully\n\nexport default firebaseInitialized","import React from 'react';\nimport './debug.scss';\n\nexport const DebugColliding = ({sprite})=> (\n  <div className='debug-colliding'>\n    {Object.entries(sprite.colliding).map(([key, value], index)=> \n      <p className={`number ${key} ${value.length > 0 && 'active'}`}>\n        {value.length}\n      </p>\n    )}\n  </div>\n)","import React from 'react';\nimport styled from 'styled-components'\n\nconst random = (seed)=> {\n  var x = Math.sin(seed++) * 10000;\n  return x - Math.floor(x);\n}\n\nconst randomColor = (letter)=> {\n  const seed = letter.codePointAt(0)\n\n  const [h, s, l] = [\n    random(seed) * 255,           // 0 to 255\n    random(seed + 1) * 35 + 65,   // 65% to 100%\n    random(seed + 2) * 20 + 40    // 40% to 60%\n  ]\n\n  return `hsl(${h}, ${s}%, ${l}%)`\n}\n\nconst LetterImageContainer = styled.div`\n  display: inline-block;\n  text-align: center;\n  width: 32px;\n  height: 32px;\n  border-radius: 0.3rem;\n  color: black;\n  background-color: ${props => randomColor(props.letter)};\n  \n  p {\n    display: inline;\n    font-weight: 800;\n    font-size: 1.6rem;\n    user-select: none;\n  }\n`\n\nconst LetterImage = (props)=> {\n  const {letter} = props\n\n  return (\n    <LetterImageContainer letter={letter} {...props}>\n      <p>{letter}</p>\n    </LetterImageContainer>\n  )\n}\n\nexport default LetterImage","\nexport const getImageFilename = (imageName, imageMap, availableImages)=> {\n  // User selected image\n  if (imageMap[imageName]) {\n    return imageMap[imageName]\n  }\n\n  // Fallback image for certain variable names (Player, Goomba etc)\n  // A null in the imageMap means the user intentionally selected ascii, so\n  // we check for undefined here specifically\n  if (imageMap[imageName] === undefined && availableImages.includes(imageName)) {\n    return imageName\n  }\n\n  // Either no fallback image or user specifically selected ascii\n  return null\n}","import React from 'react';\nimport {DebugColliding} from '../debug/DebugColliding.js';\nimport LetterImage from '../Image/LetterImage'\nimport {getImageFilename} from '../Image/helper'\nimport styled from 'styled-components'\nimport {TILE_SIZE} from './constants'\n\nconst SpriteContainer = styled.div.attrs(({ position, flash }) => ({\n  style: {\n    left: position.x,\n    top: position.y,\n    filter: flash ? 'brightness(2)' : 'none'\n  }\n}))`\n  position: relative;\n  width: 0;\n  height: 0;\n`;\n\nconst Inner = styled.div.attrs(({ flip, mirror, rotation }) => ({\n  style: {\n    width: `${TILE_SIZE}px`,\n    height: `${TILE_SIZE}px`,\n    // transform: `${flip && 'transform: scaleY(-1)'} ${mirror && 'transform: scaleX(-1)'} ${rotation && `transform: rotation3d(0, 0, 1, ${rotation}deg)`}`\n  transform: `\n    ${flip ? 'scaleY(-1)' : ''}\n    ${mirror ? 'scaleX(-1)' : ''}\n    ${rotation ? `rotate3d(0, 0, 1, ${rotation}deg)` : ''}\n  `\n  }\n}))`\n  width: ${TILE_SIZE}px;\n  height: ${TILE_SIZE}px;\n`;\n\nconst Sprite = ({availableImages, imageMap, sprite, debug})=> {\n  const {position, letter, name, flash, flip, mirror, rotation} = sprite\n  const imageFilename = getImageFilename(name, imageMap, availableImages)\n\n  return <SpriteContainer\n    position={position}\n    flash={flash}\n  >\n    <Inner\n      mirror={mirror}\n      flip={flip}\n      rotation={rotation}\n    >\n      {imageFilename\n        ? <img\n            alt=''\n            src={require(`../Game/images/${imageFilename}.png`)}\n          />\n        : <LetterImage\n            letter={letter}\n          />\n      }\n      {debug && <DebugColliding sprite={sprite} />}\n    </Inner>\n  </SpriteContainer>\n};\n\nexport default Sprite;\n","import React from 'react';\nimport styled from 'styled-components'\n\nconst Container = styled.div`\n  position: relative;\n  width: 0;\n  height: 0;\n  left: ${props => props.x}px;\n  top: ${props => props.y}px;\n`\n\nconst Explosion = styled.div`\n  width: 32px;\n  height: 32px;\n  outline: var(--light-color);\n  outline-width: 20px;\n  outline-style: solid;\n\n  @keyframes expand {\n    0% {\n      transform: scale(0.8);\n    }\n    100% {\n      transform: scale(2);\n      outline-width: 0px;\n    }\n  }\n\n  animation-name: expand;\n  animation-duration: ${props => props.duration}s;\n  animation-fill-mode: forwards;\n  animation-timing-function: ease-out;\n`\n\nconst Effect = ({effect})=>\n  <Container\n    x={effect.position.x}\n    y={effect.position.y}\n  >\n    <Explosion duration={effect.duration / 60} />\n  </Container>\n\nexport default Effect;\n","import React from 'react';\nimport {connect} from 'react-redux'\nimport Sprite from './Sprite.js';\nimport Effect from './Effect.js';\nimport styled, {css} from 'styled-components'\n\nconst Stage = styled.div`\n  width: ${props => props.width}px;\n  height: ${props => props.height}px;\n  background-color: var(--dark-color);\n  overflow: hidden;\n\n  ${props => props.shake && css`\n      transform: translate3d(\n        ${Math.random() * 8 - 4}px,\n        ${Math.random() * 8 - 4}px,\n        0px\n      );\n  `}\n`\n\nconst Game = ({\n  width, height, sprites, effects, imageMap, availableImages, shake, error, debug\n})=> (\n  <Stage width={width} height={height} shake={shake}>\n    {error && <p className='error' >{error}</p>}\n    {sprites.map((sprite)=>\n      <Sprite\n        key={sprite.id}\n        imageMap={imageMap}\n        availableImages={availableImages}\n        \n        // debug visualisation\n        sprite={sprite}\n        debug={debug}\n      />\n    )}\n    {effects.map((effect)=>\n      <Effect key={effect.id} effect={effect} />\n    )}\n  </Stage>\n);\n\nconst mapStateToProps = ({game})=> ({\n  width: game.width,\n  height: game.height,\n  sprites: game.sprites,\n  effects: game.effects,\n  imageMap: game.imageMap,\n  availableImages: game.availableImages,\n  shake: game.shake,\n  debug: game.debug,\n  error: game.error,\n  currentView: game.currentView\n})\n\nexport default connect(\n  mapStateToProps,\n  null\n)(Game);\n","import styled, {css} from 'styled-components'\n\nconst alpha = '22' // hex\n\nconst Button = styled.button`\n  border: none;\n  border-radius: 0.4rem;\n  text-transform: uppercase;\n  font-weight: 800;\n  font-size: 0.8rem;\n  min-width: 6rem;\n  padding: 0.5rem 1rem;\n  cursor: pointer;\n  background-color: ${props => props.colors.dark};\n  color: ${props => props.colors.primary};\n  \n  &:hover {\n    opacity: 0.8;\n  }\n  \n  &:active {\n    opacity: 1.0;\n    background-color: ${props => props.colors.primary}${alpha};\n  }\n\n  &:focus {\n    outline: 0;\n  }\n\n  ${props => props.secondary && css`\n    color: ${props.colors.dark};\n    background-color: transparent;\n    border: solid 2px ${props.colors.dark};\n\n    &:hover {\n      color: ${props => props.colors.primary};\n      background-color: ${props => props.colors.dark};\n    }\n  `}\n  \n  ${props => props.inverted && css`\n    color: ${props.colors.dark};\n    background-color: ${props => props.colors.primary};\n  `}\n`\n\nexport default Button\n","import React from 'react';\nimport Button from '../components/Button'\nimport './Menu.scss';\n\nconst text = {\n  win: 'Win.',\n  lose: 'Lose.',\n}\n\nexport const Menu = ({width, height, onPlay, colors, currentView})=> (\n  <div className='menu' style={{width, height}}>\n    <h1 className='title'>{text[currentView]}</h1>\n    <Button colors={colors} inverted onClick={onPlay}>\n      Play again\n    </Button>\n  </div>\n);","import React, {useEffect} from 'react';\nimport {connect} from 'react-redux'\n\nconst Loop = ({onTimeChange})=> {\n  // recursively calls itself once per frame\n  let request;\n  const advanceFrame = ()=> {\n    onTimeChange();\n    request = requestAnimationFrame(()=> advanceFrame());\n  }\n\n  useEffect(() => {\n    request = requestAnimationFrame(()=> advanceFrame());\n    return function cleanup() {\n      cancelAnimationFrame(request);\n    }\n  }, []);\n\n  return <p></p>;\n};\n\nconst mapDispatchToProps = (dispatch)=> ({\n  onTimeChange: ()=> {\n    dispatch({\n      type: 'UPDATE'\n    });\n  }\n});\n\nexport default connect(\n  null,\n  mapDispatchToProps\n)(Loop);\n","import React, {useState} from 'react'\nimport {connect} from 'react-redux'\nimport LetterImage from '../Image/LetterImage'\nimport {getImageFilename} from '../Image/helper'\n\nimport styled from 'styled-components'\n\nconst PickerContainer = styled.div`\n  position: absolute;\n  display: inline-flex;\n  cursor: pointer;\n  margin-top: -0.5rem;\n`\n\nconst PickerBox = styled.div`\n  display: flex;\n  background-color: black;\n  border: solid 1px #555;\n  border-radius: .5rem;\n  padding: 0.5rem;\n  margin-top: -0.5rem;\n  z-index: 1;\n\n  div, img {\n    margin-right: 0.5rem;\n\n    &:last-child {\n      margin-right: 0\n    }\n  }\n`\n\nconst ImagePicker = ({letter, variableName, imageMap, availableImages, onSetImage, onSetNoImage})=> {\n  const imageFilename = getImageFilename(variableName, imageMap, availableImages)\n  const [open, setOpen] = useState(false)\n\n  return (\n    <PickerContainer\n      onMouseOver={()=> setOpen(true)}\n      onMouseLeave={()=> setOpen(false)}\n    >\n      {!open\n        ?\n          <div className='code-sprite'>\n            {imageFilename\n              ? <img alt='' src={require(`../Game/images/${imageFilename}.png`)} />\n              : <LetterImage letter={letter} />\n            }\n          </div>\n        : \n          <PickerBox>\n            <LetterImage\n              letter={letter}\n              onClick={()=> onSetNoImage(variableName)}\n            />\n            {availableImages.map((imageName)=> (\n              <img\n                key={imageName}\n                alt=''\n                src={require(`../Game/images/${imageName}.png`)}\n                onClick={()=> onSetImage(variableName, imageName)}\n              />\n            ))}\n          </PickerBox>\n      }\n    </PickerContainer>\n  )\n};\n\nconst mapStateToProps = ({game})=> ({\n  imageMap: game.imageMap,\n  availableImages: game.availableImages\n})\n\nconst mapDispatchToProps = (dispatch)=> ({\n  onSetImage: (variableName, imageName)=> {\n    dispatch({\n      type: 'SET_IMAGE',\n      variableName,\n      imageName\n    });\n  },\n  onSetNoImage: (variableName)=> {\n    dispatch({\n      type: 'SET_NO_IMAGE',\n      variableName,\n    });\n  }\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(ImagePicker);\n","import React, {useEffect} from 'react';\nimport {connect} from 'react-redux';\nimport Prism from 'prismjs';\nimport {Editor} from 'slate-react';\nimport ImagePicker from '../ImagePicker/ImagePicker.js';\n\nconst makeGrammar = ()=> {\n  return {\n    comment: /\\/\\/.*/,\n    variable: [\n      {\n        pattern: new RegExp('[^ ]{1} = ([A-Z]+)', 'i')\n      },\n      // {\n      //   pattern: new RegExp('or (.+)\\\\b', 'i'),\n      // }\n    ]\n  }\n}\n\nconst grammar = makeGrammar();\n\nconst getContent = (token)=> {\n  if (typeof token == 'string') {\n    return token\n  } else if (typeof token.content == 'string') {\n    return token.content\n  } else {\n    return token.content.map(getContent).join('')\n  }\n}\n\nconst decorateNode = (node, editor, next)=> {\n  const others = next() || []\n  const texts = node.getTexts().toArray()\n  const string = texts.map(t => t.text).join('\\n')\n\n  if (texts.length !== 1) {\n    return others;\n  }\n\n  const tokens = Prism.tokenize(string, grammar)\n  const decorations = []\n  let startText = texts.shift()\n  let endText = startText\n  let startOffset = 0\n  let endOffset = 0\n  let start = 0\n\n  for (const token of tokens) {\n    startText = endText\n    startOffset = endOffset\n\n    const content = getContent(token)\n    const newlines = content.split('\\n').length - 1\n    const length = content.length - newlines\n    const end = start + length\n\n    let available = startText.text.length - startOffset\n    let remaining = length\n\n    endOffset = startOffset + remaining\n\n    while (available < remaining && texts.length > 0) {\n      endText = texts.shift()\n      remaining = length - available\n      available = endText.text.length\n      endOffset = remaining\n    }\n\n    if (typeof token != 'string') {\n      const dec = {\n        anchor: {\n          key: startText.key,\n          offset: startOffset,\n        },\n        focus: {\n          key: endText.key,\n          offset: endOffset,\n        },\n        mark: {\n          type: token.type,\n        },\n      }\n\n      decorations.push(dec)\n    }\n\n    start = end\n  }\n\n  return [...others, ...decorations]\n}\n\nconst renderMark = (props, editor, next) => {\n  const { children, attributes, node } = props\n\n  switch (props.mark.type) {\n    case 'variable':\n      const [key, right] = node.text.split('=').map((str)=> str.trim())\n      const names = right.split(' or ')\n\n      return <span {...attributes}>\n          {children}\n          <ImagePicker letter={key} variableName={names[0]} />\n        </span>\n\n    case 'comment': \n      return (\n        <span {...attributes} style={{ opacity: '0.33' }}>\n          {children}\n        </span>\n      )\n    case 'keyword':\n      return (\n        <span {...attributes} style={{ fontWeight: 'bold' }}>\n          {children}\n        </span>\n      )\n    default:\n      return next()\n  }\n}\n\nconst Code = ({user, name, id, code, imageMap, setCode, save, compile})=> {\n  // manually trigger code change on first load\n  useEffect(() => {\n    compile(code);\n  }, [])\n\n  return (\n    <Editor\n      className={'code'}\n      value={code}\n      onChange={({value})=> {\n        setCode(value)\n      }}\n      decorateNode={decorateNode}\n      renderMark={(props, editor, next)=>\n        renderMark(props, editor, next, imageMap)\n      }\n      spellCheck={false}\n    />\n  )\n};\n\nconst mapStateToProps = ({app, game})=> ({\n  user: app.user,\n  name: app.name,\n  id: app.id,\n  code: app.code,\n  width: game.width, \n  height: game.height,\n  imageMap: game.imageMap\n})\n\nconst mapDispatchToProps = (dispatch)=> ({\n  setCode: (code)=> {\n    dispatch({\n      type: 'UPDATE_CODE',\n      code\n    })\n  },\n  compile: (code)=> {\n    dispatch({\n      type: 'COMPILE',\n      code\n    });\n  }\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Code);\n","import React from 'react';\nimport './Tile.scss';\n\nconst getPositionStyle = (x, y)=> ({\n  position: 'relative', left: x, top: y\n});\n\nconst Tile = ({x, y, img, onClick})=> (\n  <div className='tile' style={getPositionStyle(x, y)}>\n    <img\n      src={require(`../Game/images/tiles/${img}.png`)}\n      alt=''\n      onClick={()=> onClick()}\n    />\n  </div>\n);\n\nexport default Tile;\n","import React, {useState} from 'react'\nimport {connect} from 'react-redux'\nimport Dialog from '@material-ui/core/Dialog';\nimport Tile from './Tile.js'\nimport {TILE_SIZE} from '../Game/constants.js';\nimport './SpriteEditor.scss';\n\nconst SpritePicker = ({images, tileSets, selectedTileSet, onSelect})=> (\n  <div className='image-list'>\n    {images.map((src, index)=>{\n      return (\n        <img\n          src={src}\n          alt=''\n          className={`image ${index === selectedTileSet && 'selected'}`}\n          onClick={()=> onSelect(index)}\n        />\n      )\n    })}\n  </div>\n)\n\nconst Preview = ({tiles, selectedTile, tileImages, onSelect})=> (\n  <div className='preview'>\n    {tiles.map((rowArr, row)=> (\n      rowArr.map((tileIndex, col)=> (\n        <Tile\n          img={tileImages[tileIndex]}\n          x={col * TILE_SIZE}\n          y={row * TILE_SIZE}\n          onClick={()=> onSelect(row, col, selectedTile)}\n        />\n      ))\n    ))}\n  </div>\n)\n\nconst TilePicker = ({selectedTile, tileImages, onSelect})=> (\n  <div className='picker'>\n    {tileImages.map((name, index)=> (\n      <img\n        key={name}\n        alt=''\n        className={index === selectedTile ? 'selected' : ''}\n        src={require(`../Game/images/tiles/${name}.png`)}\n        onClick={()=> onSelect(index)}\n      />\n    ))}\n  </div>\n)\n\nconst SpriteEditor = ({tileSets, tileImages, images, open, updateTileSets, onClose})=> {  \n  const [selectedTileSet, setSelectedTileSet] = useState(0);\n  const [selectedTile, setSelectedTile] = useState(0);\n  const tiles = tileSets[selectedTileSet]\n\n  return (\n    <Dialog open={open} onClose={onClose}>\n      <div className='container'>\n        <div className='left'>\n          <SpritePicker\n            images={images}\n            tileSets={tileSets}\n            selectedTileSet={selectedTileSet}\n            onSelect={setSelectedTileSet}\n          />\n        </div>\n        <div className='right'>\n          <Preview\n            tiles={tiles}\n            tileImages={tileImages}\n            selectedTile={selectedTile}\n            onSelect={(row, col, newTileIndex)=> {\n              const newTileSets = [...tileSets]\n              newTileSets[selectedTileSet][row][col] = newTileIndex\n              updateTileSets(newTileSets)\n            }}\n          />\n          <TilePicker\n            tileImages={tileImages}\n            selectedTile={selectedTile}\n            onSelect={setSelectedTile}\n          />\n        </div>\n      </div>\n    </Dialog>\n  )\n}\n\nconst mapStateToProps = ({game, spriteEditor})=> ({\n  open: spriteEditor.open,\n  tileImages: spriteEditor.tileImages,\n  images: spriteEditor.images,\n  tileSets: spriteEditor.tileSets\n})\n\nconst mapDispatchToProps = (dispatch)=> ({\n  updateTileSets: (tileSets)=> {\n    dispatch({\n      type: 'spriteEditor/UPDATE_TILESETS',\n      tileSets,\n    })\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(SpriteEditor)\n","import {useEffect} from 'react'\nimport {connect} from 'react-redux'\nimport firebase from '../firebase.js'\nimport 'firebase/auth'\nimport Plain from 'slate-plain-serializer'\n\n\nconst firestore = firebase.firestore()\n\nconst Persister = ({user, name, id, code, loadGames, clearGames, saveGame})=> {\n\n  // load games as soon as user is signed in and whenever user changes\n  useEffect(() => {\n    if (user) {\n      loadGames(user)\n    }\n    else {\n      clearGames()\n    }\n  }, [user])\n\n  // save games whenever a change is made\n  useEffect(() => {\n    saveGame(name, id, code, user)\n  }, [name, id , code])\n\n  return null\n}\n\nconst mapStateToProps = ({app})=> ({\n  user: app.user,\n  name: app.name,\n  id: app.id,\n  code: app.code\n})\n\nconst mapDispatchToProps = (dispatch)=> ({\n  saveGame: (name, id, code, user)=> {\n    const codeText = Plain.serialize(code)\n    firestore.collection(user.uid).doc(id).set({\n      name,\n      id,\n      code: codeText\n    })\n    .then(function() {\n        console.log(\"Document successfully written!\");\n    })\n    .catch(function(error) {\n        console.error(\"Error writing document: \", error);\n    });\n  },\n  loadGames: (user)=> {\n    const gamesRef = firestore.collection(user.uid)\n      gamesRef.get().then(function(querySnapshot) {\n        let games = []\n        querySnapshot.forEach(function(doc) {\n          const {name, id, code} = doc.data()\n          games.push({name, id, code})\n        });\n        dispatch({\n          type: 'SET_GAMES',\n          games\n        });\n      })\n  },\n  clearGames: ()=> {\n    dispatch({\n      type: 'SET_GAMES',\n      games: []\n    });\n  }\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Persister);\n","import React from 'react'\nimport styled from 'styled-components'\n\nconst Blanket = styled.div`\n  height: 100%;\n  width: 100%;\n  position: fixed;\n  z-index: 1;\n  left: 0;\n  top: 0;\n  background-color: ${props => props.colors.dark};\n  overflow-x: hidden;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`\n\nconst Contents = styled.div`\n  width: 80%;\n  color: ${props => props.colors.dark};\n  background-color: ${props => props.colors.primary};\n  border-radius: 0.5rem;\n  padding: 2rem;\n  top: 10%;\n  position: absolute;\n  margin-bottom: 10%;\n\n  h2 {\n    margin-top: 1.5rem;\n    line-height: 2rem;\n  }\n`\n\nconst Modal = ({colors, onClose, children})=> (\n  <Blanket colors={colors} onClick={onClose}>\n    <Contents colors={colors} onClick={(e)=> e.stopPropagation()}>\n      {children}\n    </Contents>\n  </Blanket>\n)\n\nexport default Modal\n","import React, {useState, Fragment} from 'react'\nimport {connect} from 'react-redux'\nimport Textarea from 'react-textarea-autosize'\nimport Plain from 'slate-plain-serializer'\nimport {examples} from './exampleCode'\nimport Button from '../components/Button'\nimport Modal from '../components/Modal'\nimport styled from 'styled-components'\n\nconst CodeExample = styled.div`\n  padding: 1.5rem;\n  margin-bottom: 1rem;\n  background-color: ${props => props.colors.dark};\n  border-radius: 0.5rem;\n\n  textarea {\n    background-color: transparent;\n    color: var(--primary-color);\n    padding: 0rem;\n    border: none;\n    overflow: hidden;\n    resize: none;\n    outline: none;\n    line-height: 1rem;\n    font-family: 'Fira Code';\n    font-size: 1rem;\n    width: 100%;\n    padding: 0;\n  }\n`\n\nconst ColumnLayout = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: baseline;\n  justify-content: space-between;\n`\n\nconst ExamplesModal = ({colors, loadPreset})=> {\n  const [visible, setVisible] = useState(false)\n\n  return visible \n  ?\n    <Modal colors={colors} onClose={()=> setVisible(false)}>\n      <h1>Examples</h1>\n      {Object.entries(examples).map(([key, code])=> {\n        \n        return <Fragment key={key}>\n          <ColumnLayout>\n            <h2>{key}</h2>\n            <Button colors={colors} secondary onClick={()=> {\n              loadPreset(code)\n              setVisible(false)\n            }}>\n              Load\n            </Button>\n          </ColumnLayout>\n          <CodeExample colors={colors}>\n            <Textarea value={code} />\n          </CodeExample>\n        </Fragment>\n      }\n      )}\n    </Modal>\n  :\n    <Button colors={colors} onClick={()=> setVisible(true)}>\n      Examples\n    </Button>\n}\n\nconst mapStateToProps = ()=> ({})\n\nconst mapDispatchToProps = (dispatch)=> ({\n  loadPreset: (codeText)=> {\n    const code = Plain.deserialize(codeText)\n\n    dispatch({\n      type: 'LOAD_CODE',\n      code\n    })\n    dispatch({\n      type: 'COMPILE',\n      code\n    });\n  }\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(ExamplesModal);\n","import React, {useState} from 'react'\nimport {connect} from 'react-redux'\nimport Plain from 'slate-plain-serializer'\nimport Button from '../components/Button'\nimport Modal from '../components/Modal'\n\nconst GamesModal = ({colors, games, loadGame})=> {\n  const [visible, setVisible] = useState(false)\n\n  return visible \n  ?\n    <Modal colors={colors} onClose={()=> setVisible(false)}>\n      <h1>Games</h1>\n      {games.map(({name, id, code})=>\n        <div className='item' key={id}>\n          <h2>{name}</h2>\n          <Button secondary colors={colors} onClick={()=> {\n            loadGame(code)\n            setVisible(false)\n          }}>\n            Load\n          </Button>\n        </div>\n      )}\n    </Modal>\n  :\n    <Button colors={colors} onClick={()=> setVisible(true)}>\n      Games\n    </Button>\n}\n\nconst mapStateToProps = ({app})=> ({\n  games: app.games\n})\n\nconst mapDispatchToProps = (dispatch)=> ({\n  loadGame: (codeText)=> {\n    const code = Plain.deserialize(codeText)\n\n    dispatch({\n      type: 'LOAD_CODE',\n      code\n    })\n    dispatch({\n      type: 'COMPILE',\n      code\n    });\n  }\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(GamesModal);\n","import styled from 'styled-components'\n\n\nconst alpha = 30 // this is a number, but will end up a hex string\n\nconst Input = styled.input`\n  background-color: ${props => props.colors.primary}${alpha};\n  &:hover, &:focus{\n    background-color: ${props => props.colors.primary}${alpha * 1.5};\n  }\n  &:focus{\n    outline: none;\n  }\n  color: ${props => props.colors.primary};\n  font-size: 0.8rem;\n  font-weight: 800;\n  padding: 0.5rem;\n  border: none;\n  border-radius: 0.3rem;\n`\n\nexport default Input","import styled from 'styled-components'\nimport Button from './Button'\n\n\nconst IconButton = styled(Button)`\n  @keyframes grow {\n    0% {\n      transform: scale(1.0);\n      easing: 'ease-out'\n    }\n    30% {\n      transform: scale(1.3);\n      easing: 'ease-in-out'\n    }\n    100% {\n      transform: scale(1.2);\n    }\n  }\n\n  @keyframes shrink {\n    0% {\n      transform: scale(1.2);\n      easing: 'ease-out'\n    }\n    30% {\n      transform: scale(0.9);\n      easing: 'ease-in-out'\n    }\n    100% {\n      transform: scale(1.0);\n    }\n  }\n\n  min-width: auto;\n  padding: 0;\n  background-color: transparent;\n\n  animation-name: shrink;\n  animation-duration: 0.2s;\n  animation-fill-mode: forwards;\n\n  &:hover {\n    animation-name: grow;\n    animation-duration: 0.2s;\n    animation-fill-mode: forwards;\n  }\n`\n\nexport default IconButton\n","\nexport const darkColors = {\n  primary: '#F1A0A0',\n  secondary: '#70EFA6',\n  dark: '#000000',\n  light: '#FDF6E2'\n}\n\nexport const lightColors = {\n  primary: '#43153F',\n  secondary: '#70EFA6',\n  dark: '#FDF6E2',\n  light: '#FFFFFF'\n}","import React from 'react'\nimport {connect} from 'react-redux'\nimport {HotKeys} from 'react-hotkeys'\nimport {setInput, cancelInput, toggleTheme} from '../App/actions.js'\nimport {toggleDebug} from '../Game/actions.js'\n\n\nconst keyMap = {\n  'up': {sequence: 'up', action: 'keydown'},\n  'down': {sequence: 'down', action: 'keydown'},\n  'left': {sequence: 'left', action: 'keydown'},\n  'right': {sequence: 'right', action: 'keydown'},\n  'action1': {sequence: 'x', action: 'keydown'},\n  'action2': {sequence: 'z', action: 'keydown'},\n\n  'cancel_up': {sequence: 'up', action: 'keyup'},\n  'cancel_down': {sequence: 'down', action: 'keyup'},\n  'cancel_left': {sequence: 'left', action: 'keyup'},\n  'cancel_right': {sequence: 'right', action: 'keyup'},\n  'cancel_action1': {sequence: 'x', action: 'keyup'},\n  'cancel_action2': {sequence: 'z', action: 'keyup'},\n};\n\nconst handlers = (onSetInput, onCancelInput, onReset, onRun, onToggleDebug, isGameActive)=> ({\n  'up': ()=> onSetInput('up'),\n  'down': ()=> onSetInput('down'),\n  'left': ()=> onSetInput('left'),\n  'right': ()=> onSetInput('right'),\n  'action1': ()=> onSetInput('action1'),\n  'action2': ()=> onSetInput('action2'),\n  'r': ()=> onReset(),\n  'd': ()=> onToggleDebug(),\n  'space': ()=> onRun(!isGameActive),\n\n  'cancel_up': ()=> onCancelInput('up'),\n  'cancel_down': ()=> onCancelInput('down'),\n  'cancel_left': ()=> onCancelInput('left'),\n  'cancel_right': ()=> onCancelInput('right'),\n  'cancel_action1': ()=> onCancelInput('action1'),\n  'cancel_action2': ()=> onCancelInput('action2'),\n});\n\nconst Keyboard = ({\n    code, compile, isGameActive, setGameActive, onToggleDebug,\n    onSetInput, onCancelInput, children\n})=>\n  <HotKeys\n    handlers={handlers(\n      onSetInput,\n      onCancelInput,\n      ()=> compile(code),\n      (active)=> setGameActive(active),\n      ()=> onToggleDebug(),\n      isGameActive\n    )}\n    keyMap={keyMap}\n  >\n  {children}\n  </HotKeys>\n\nconst mapStateToProps = ({app, game})=> ({\n  user: app.user,\n  name: app.name,\n  id: app.id,\n  code: app.code,\n  theme: game.theme,\n  isGameActive: app.active,\n  imageMap: game.imageMap,\n  width: game.width,\n  height: game.height,\n  debug: game.debug,\n  error: game.error,\n  currentView: game.currentView\n})\n\nconst mapDispatchToProps = (dispatch)=> ({\n  compile: (code)=> {\n    dispatch({\n      type: 'COMPILE',\n      code\n    });\n  },\n  setGameActive: (active)=> {\n    dispatch({\n      type: 'SET_ACTIVE',\n      active\n    });\n  },\n  onSetInput: (input)=> {\n    dispatch(setInput(input));\n  },\n  onCancelInput: (input)=> {\n    dispatch(cancelInput(input));\n  },\n  onToggleDebug: ()=> {\n    dispatch(toggleDebug());\n  },\n  onToggleTheme: ()=> {\n    dispatch(toggleTheme());\n  },\n  onOpenCloseSpriteEditor: (open)=> {\n    dispatch({type: 'spriteEditor/SET_OPEN', open: open})\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Keyboard);\n","\nexport const setInput = (input)=> ({\n  type: 'SET_INPUT',\n  input\n})\n\nexport const cancelInput = (input)=> ({\n  type: 'CANCEL_INPUT',\n  input\n})\n\nexport const toggleTheme = ()=> ({\n  type: 'TOGGLE_THEME'\n})\n","\nexport const toggleDebug = (active)=> ({\n  type: 'TOGGLE_DEBUG',\n  active\n})\n\n","import React from 'react'\nimport {connect} from 'react-redux'\nimport firebase from '../firebase.js'\nimport * as firebaseApp from 'firebase/app'\nimport 'firebase/auth'\n\nimport Game from '../Game/Game.js'\nimport {Menu} from '../Menu/Menu.js'\nimport Loop from '../Game/Loop.js'\nimport Code from '../Code/Code.js'\nimport SpriteEditor from '../SpriteEditor/SpriteEditor'\nimport Persister from '../Persistor/Persistor'\nimport ExamplesModal from '../ExamplesModal/ExamplesModal'\nimport GamesModal from '../GamesModal/GamesModal'\nimport {toggleTheme} from './actions.js'\nimport CustomProperties from 'react-custom-properties'\nimport Input from '../components/Input'\nimport Button from '../components/Button'\nimport IconButton from '../components/IconButton'\n\nimport './App.scss'\nimport styled from 'styled-components'\nimport moon from '../icons/moon.svg'\nimport sun from '../icons/sun.svg'\nimport play from '../icons/play.svg'\nimport stop from '../icons/stop.svg'\nimport {darkColors, lightColors} from './colors'\nimport Keyboard from '../Keyboard/Keyboard'\n\n\nconst providers = {\n  google: new firebaseApp.auth.GoogleAuthProvider(),\n}\n\nconst AppContainer = styled.div`\n  display: flex;\n  height: 100%;\n  background-color: ${props => props.colors.primary};\n\n  @media only screen and (max-width: 900px) {\n    flex-direction: column-reverse;\n  }\n`\n\nconst App = ({\n    name, code, compile, theme, imageMap, width, height,\n    isGameActive, currentView, setGameActive, onOpenCloseSpriteEditor,\n    onToggleTheme, updateName, user, signOut, signInWithGoogle\n})=> {\n  const colors = theme === 'light' ? lightColors : darkColors;\n\n  return (\n    <CustomProperties className=\"custom-properties-container\" properties={{\n      '--primary-color': colors.primary,\n      '--secondary-color': colors.secondary,\n      '--dark-color': colors.dark,\n      '--primary-transparent-color': colors.primaryTransparent,\n      '--light-color': colors.light,\n      '--hover-color': `${colors.primary}22`  // 22 is is the alpha in hex\n    }}>\n      <AppContainer colors={colors}>\n        {user && <Persister />}\n        <div className=\"left\">\n          <header>\n            <h1 className='logo'>micro gg</h1>\n            <Input\n              type=\"text\"\n              value={name}\n              onChange={(e)=> updateName(e.target.value.toUpperCase())}\n              colors={colors}\n              onFocus={(e)=> e.target.select()}\n            />\n            <GamesModal colors={colors} />\n            <ExamplesModal colors={colors} />\n            {\n              user\n                ? <Button onClick={signOut} colors={colors}>\n                    Sign out\n                  </Button>\n                : <Button onClick={signInWithGoogle} colors={colors}>\n                    Sign in with Google to save\n                  </Button>\n            }\n          <IconButton colors={colors} className='icon' onClick={()=> onToggleTheme()}>\n            {theme === 'dark'\n              ? <img src={sun} alt=\"Light UI\" />\n              : <img src={moon} alt=\"Dark UI\" />\n            }\n          </IconButton>\n          </header>\n          <Code imageMap={imageMap} />\n        </div>\n        <Keyboard>\n          <div className=\"right\">\n            <header>\n              {isGameActive\n                ? <IconButton colors={colors} className='icon stop' onClick={()=> {\n                    compile(code)\n                    setGameActive(false)\n                  }}>\n                    <img src={stop} alt=\"Stop\" />\n                  </IconButton>\n                : <IconButton colors={colors} className='icon play' onClick={()=> {\n                    compile(code)\n                    setGameActive(true)\n                  }}>\n                    <img src={play} alt=\"Play\" />\n                  </IconButton>\n              }\n              {isGameActive && <Loop />}\n            </header>\n            <div className=\"game-container\">\n              <SpriteEditor\n                onClose={()=> onOpenCloseSpriteEditor(false)}\n              />\n              {currentView === 'game'\n                ? <Game />\n                : <Menu\n                    width={width}\n                    height={height}\n                    onPlay={()=> {\n                      compile(code)\n                      setGameActive(true)\n                    }}\n                    colors={colors}\n                    currentView={currentView}\n                  />\n              }\n            </div>\n          </div>\n        </Keyboard>\n      </AppContainer>\n    </CustomProperties>\n  );\n};\n\nconst mapStateToProps = ({app, game})=> ({\n  user: app.user,\n  name: app.name,\n  id: app.id,\n  code: app.code,\n  theme: app.theme,\n  isGameActive: app.active,\n  currentView: game.currentView,\n  width: game.width,\n  height: game.height\n})\n\nconst mapDispatchToProps = (dispatch)=> ({\n  updateName: (name)=> {\n    dispatch({\n      type: 'SET_NAME',\n      name\n    });\n  },\n  signOut: ()=> {\n    firebase.auth().signOut().then(function() {\n      dispatch({\n        type: 'SIGN_OUT'\n      });\n    }).catch(function(error) {\n      console.error('could not sign out')\n    });\n  },\n  signInWithGoogle: ()=> {\n    firebase.auth().signInWithPopup(providers.google).then(function(result) {\n      // var token = result.credential.accessToken;\n      dispatch({\n        type: 'SET_USER',\n        user: result.user\n      });\n    }).catch(function(error) {\n      console.error(error)\n    });\n  },\n  compile: (code)=> {\n    dispatch({\n      type: 'COMPILE',\n      code\n    });\n  },\n  setGameActive: (active)=> {\n    dispatch({\n      type: 'SET_ACTIVE',\n      active\n    });\n  },\n  onToggleTheme: ()=> {\n    dispatch(toggleTheme());\n  },\n  onOpenCloseSpriteEditor: (open)=> {\n    dispatch({type: 'spriteEditor/SET_OPEN', open: open})\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(App);\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport {Provider} from 'react-redux'\nimport {createStore} from 'redux'\nimport rootReducers from './reducers'\nimport './index.css'\nimport './fonts/FiraCode/fira_code.css'\nimport App from './App/App.js'\nimport './firebase.js'  // initalise firebase singleton\n\n\nconst store = createStore(\n  rootReducers,\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\n )\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n)\n"],"sourceRoot":""}